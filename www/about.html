<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Alvaro Santamaría" />
  <title>SARI documentation - version agosto 2025</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel='stylesheet' href='https://www.w3schools.com/w3css/4/w3.css'>
  
  
  
</head>
<body>
<div class='w3-sidebar w3-bar-block' style='width:15%; padding: 1%;'>
<p><a href='#overview'><a href='#overview' target='_self'>SARI overview</a></a></p>
<p><a href='#i.-input-data-and-format'><a href='#input-format' target='_self'>Input data and format</a></a><br />
<a href='#ii.-plot-controls'><a href='#plot-controls' target='_self'>Plot controls</a></a><br />
<a href='#iii.-ancillary-information'><a href='#ancillary-information' target='_self'>Ancillary information</a></a><br />
<a href='#iv.-fit-controls'><a href='#fit-controls' target='_self'>Fit controls</a></a><br />
<a href='#v.-additional-fit'><a href='#additional-fit' target='_self'>Additional fit</a></a></p>
<p><a href='#interactive-operation'><a href='#interactive-operation' target='_self'>Interactive operation</a></a><br />
<a href='#example-of-use'><a href='#example-use' target='_self'>Example of use</a></a><br />
<a href='#known-issues'><a href='#known-issues' target='_self'>Known issues</a></a></p>
<p><a href='#acknowledgements'><a href='#acknowledgements' target='_self'>Acknowledgements</a></a><br />
<a href='#references'><a href='#references' target='_self'>References</a></a><br />
<a href='#author'><a href='#author' target='_self'>Contact author</a></a><br />
<a href='#policy'><a href='#policy' target='_self'>Private policy</a></a></p>
</div> 
<div style='margin-left:10%; padding: 1% 5%;'>
<header id="title-block-header">
<h1 class="title">SARI documentation - version agosto 2025</h1>
<p class="author">Alvaro Santamaría</p>
</header>
<base target="_blank">
<h3 id="contents">
</h3>
<h1 id="contents">Contents</h1>
<p><a href="#overview"><a href="#overview" target="_self">SARI overview</a></a></p>
<p><a href="#i.-input-data-and-format"><a href="#input-format" target="_self">Input data and format</a></a><br />
<a href="#ii.-plot-controls"><a href="#plot-controls" target="_self">Plot controls</a></a><br />
<a href="#iii.-ancillary-information"><a href="#ancillary-information" target="_self">Ancillary information</a></a><br />
<a href="#iv.-fit-controls"><a href="#fit-controls" target="_self">Fit controls</a></a><br />
<a href="#v.-additional-fit"><a href="#additional-fit" target="_self">Additional fit</a></a></p>
<p><a href="#interactive-operation"><a href="#interactive-operation" target="_self">Interactive operation</a></a><br />
<a href="#example-of-use"><a href="#example-use" target="_self">Example of use</a></a><br />
<a href="#known-issues"><a href="#known-issues" target="_self">Known issues</a></a></p>
<p><a href="#acknowledgements"><a href="#acknowledgements" target="_self">Acknowledgements</a></a><br />
<a href="#references"><a href="#references" target="_self">References</a></a><br />
<a href="#author"><a href="#author" target="_self">Contact author</a></a><br />
<a href="#policy"><a href="#policy" target="_self">Private policy</a></a></p>
<hr />
<h3 id="overview">
</h3>
<h1 id="sari-overview">SARI overview</h1>
<p>SARI allows you to visualize discrete time series data, analyze and fit unidimensional models interactively and save the results using a <a href="https://en.wikipedia.org/wiki/WYSIWYG">WYSIWYG</a> web interface.</p>
<p>It has been developed in the <a href="https://www.r-project.org">R programming language</a>, under the interactive framework of the <a href="https://shiny.rstudio.com">Shiny R package</a>.<br />
Currently tested in R version 4.4.3.</p>
<p>The development of SARI started in 2017 to analyze GNSS position time series from the <a href="http://renag.resif.fr/en/">GNSS National Network (RENAG)</a> (<a href="#references"><a href="#references" target="_self">RESIF 2017</a></a>) and it is oriented towards this kind of dataset, but any other type of series can be used as long as the series format is simple, consistent and does not have uncommented alphabetic characters.</p>
<p>SARI is available on all platforms, except mobile devices, and can be accessed in three ways:</p>
<ul>
<li>Online from the <a href="https://alvarosg.shinyapps.io/sari">Shinyapps server</a></li>
<li>Offline, from a containerized environment available on <a href="https://hub.docker.com/r/alvarosg/sari">DockerHub</a>.</li>
<li>Offline, after installing the code available on <a href="https://github.com/alvarosantamariagomez/sari">GitHub</a>.</li>
</ul>
<p>Depending on the way SARI is accessed, there are several ways to run SARI: bookmark on web browser, weblink, Docker Desktop, RStudio, R console or a UNIX-like console. The only requirement is to use a desktop environnment where a web browser can run.<br />
All the different ways to run SARI are implemented in the <a href="https://github.com/alvarosantamariagomez/sari/blob/main/scripts/sari.sh">SARI shell script</a>. This script can be used to start SARI while loading series on a local or remote session. For the ultimate easiness, the SARI shell script also allows creating convenient desktop shorcuts on any system to run SARI with just one click (see an example BAT file <a href="https://github.com/alvarosantamariagomez/sari/tree/main/scripts">here</a>).</p>
<p>This document describes the different options and functionalities implemented in the current version of SARI. Within this document:<br />
* GUI options are given in this <code>red lettering</code>.<br />
* GUI specific input values and files are given in <em>italics</em>.<br />
* Internal and external links are given in this <a href="#" target="_self">blue</a>.</p>
<p>Further details and some examples can be found in the <a href="https://sari-gnss.github.io">SARI official website</a><br />
and in Santamaría-Gómez, A. (2019) SARI: interactive GNSS position time series analysis software. GPS solutions, 23:52. DOI: <a href="https://link.springer.com/article/10.1007/s10291-019-0846-y">10.1007/s10291-019-0846-y</a></p>
<p>A ~40 min video tutorial is also available on <a href="https://youtu.be/Zt61jzehhoc">YouTube</a>. This tutorial was made with SARI version “mayo 2021” and does not include the latest additions and corrections, but it is still valid to learn the general usage of the app.</p>
<p>The history of changes and corrections is available in the <a href="https://github.com/alvarosantamariagomez/sari/blob/main/www/changelog.md">changelog file</a>.</p>
<p><br></p>
<p>Current SARI version: <em>agosto 2025</em> – “The sorcerers of antiquity called the use of this language ‘<em>spells</em>’. But if that word offends your modern sensibilities, you can call it a program.”</p>
<hr />
<h3 id="input-format">
</h3>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h1 id="sari-mechanics">SARI mechanics</h1>
<p>The SARI interface is divided into two panels with separate vertical scrolling: the left panel contains all the processing options while the right panel is for visualization of the series and the analysis.<br />
The processing options on the left panel are grouped into five blocks that can be expanded and collapsed with a single click on their header.<br />
Note that some OS and some web browsers apply a display scaling to all web pages by default. It is recommended to adjust the browser zoom (usually ctrl + mouse wheel) so that all the controls, buttons, plots, etc. on both panels fit comfortably on the screen.</p>
<h2 id="i.-input-data-and-format">I. Input data and format</h2>
<p>This block allows uploading and setting the series format, if necessary, before plotting. The input series file must be a text file with standard encoding (ASCII, UTF-8) and organized in columns generally corresponding to the epochs, the observed variables and, optionally, their error bars. The series does not need to be evenly sampled, but only one point per epoch is allowed.<br />
While the following instructions are provided mostly for GNSS position time series, they should also work for any type of time series, provided the file format matches the specifications given below.</p>
<p>There are three different ways to upload a time series on SARI:</p>
<p id="format">
</p>
<ol type="1">
<li>The user can upload GNSS series from <ins><strong>local files</strong></ins> using the <code>Input series file</code> option.<br />
GNSS series are allowed in the <em>NEU/ENU</em> format (North/East, East/North, Up) or in the file formats produced by <em>PBO</em> (with extension <em>.pos</em>, version 1.1.0) and <em>NGL</em> (with extension <em>.tenv3</em>). For series that are not in <em>NEU/ENU</em>, <em>PBO</em> or <em>NGL</em> format, the user must use the <em>1D</em> option, then set the column separator (blanks, commas or semi-colons) and then set the column numbers containing the epochs, the variable and the error bars if available.
<p id="tunits">
</p>
The input file can contain comments anywhere identified by a <em>#</em> at the beginning of the line. These lines will be skipped. In case uncommented text is found, the behavior depends on the requested series format:<br />
Any non-numeric value in a <em>NEU/ENU</em> or <em>1D</em> series will make the full line to be skipped.<br />
For the <em>PBO</em> and <em>NGL</em> series, the headers are recognized and skipped, also the first two columns of the <em>NGL</em> files and the last column of the <em>PBO</em> files. However, any other non-numeric value in these files will stop the app.<br />
Data records having a NA, NaN or Inf/inf entries will be treated as valid not-available or not-a-number numeric values and will be automatically skipped, but na, Na, nan, NAN or any other string will be considered as unwanted text.
<p>
</p>
For <em>NEU/ENU</em> and <em>1D</em> series, the user may need to set the <code>Time units</code> (days, weeks or years) and the <code>Series units</code> (metres or millimetres) of the input series, which may be otherwise unknown to SARI (some <em>NEU/ENU</em> series are recognized by SARI and the format will be set automatically).<br />
The user must pay special attention to the time units that are set before a <em>NEU/ENU</em> or <em>1D</em> series are plotted, as these units will define the sampling of the series for the rest of the analysis. Changing the time units after the series have been plotted will change the units of the time axis, but not its sampling. For instance, when changing the time units of an already plotted daily series from years to days or weeks, the sampling units will change from one point per ~0.0027 years into one point per day or per ~0.14 weeks; the already defined sampling period will not change, only its units does. The correct use of several options in SARI depends on defining the correct sampling of the series before plotting them, and this is done by setting the correct time units of the series.<br />
For the <em>PBO</em> and <em>NGL</em> series, different time units are provided by these formats, so changing the <code>Time units</code> is just optional as the sampling period is already known (daily). The latter also applies in case of a <em>NEU/ENU</em> series where the epochs are provided in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601 calendar date and time format</a>.
<p>
</p>
If the series does not contain error bars, or the user does not want to use them, it is possible to turn the error bars off in the processing using the <code>use error bars</code> option. By default, they are always on.
<p id="header">
</p>
If the format of the input file is not known (content of columns, separation, etc.), it is possible to print on screen the first lines of the input series to assess the corresponding format before plotting using the <code>show series header</code> option. After the series has been plotted, if it is not a <em>1D</em> series, this option will show the first lines of the coordinate component that has been extracted from the input file and is being used in the analysis.
<p>
</p>
<p>When the format of the series is set, click the <code>Plot</code> button in the <a href="#ii.-plot-controls"><a href="#plot-controls" target="_self">Plot controls</a></a> block.</p></li>
<li><p>The user can automatically download GNSS series available at specific remote <ins><strong>web servers</strong></ins>.<br />
This is done via the options: <code>server</code>, <code>product</code> and <code>station</code>. To download a series, the user must first select the <code>server</code> from those available in the dropdown menu, and then select the <code>product</code>. If only one <code>product</code> is available for the selected <code>server</code>, then it will be selected automatically. With the <code>server</code> and <code>product</code> selected, SARI will download the list of available stations from the server and for the selected product.<br />
Depending on the connection and the lenght of the list of stations, the download may take up to a few seconds. For some servers for which this operation is sensibly long, a pre-downloaded list of stations is included in SARI allowing for a faster interaction with the remote server. The pre-downloaded lists of stations are updated with each new SARI version.<br />
Once the list of stations from the selected server and product are shown, you can type in the first characters of the <code>station</code> name to filter the list of stations available.<br />
When a <code>station</code> is selected, the series will be downloaded and plotted automatically, i.e. there is no need to set the format and units as these are already known.<br />
Similar options are available for downloading a secondary series (see an example below and the <a href="#iii.-ancillary-information"><a href="#ancillary-information" target="_self">Ancillary information</a></a> block for further details).</p></li>
<li>The values for the <code>server</code>, <code>product</code> and <code>station</code> options can also be provided in any order as a <ins><strong>query string</strong></ins> after the base SARI URL on the address bar of the browser.<br />
These three parameters can be defined for both the primary and secondary series at the same time. For example, adding this query string<br />
<span style="color: red;">?product=SPOTGINS_POS&amp;station=CRAL00FRA&amp;server=FORMATERRE&amp;server2=NGL&amp;product2=IGS14&amp;station2=CRAL</span><br />
at the end of the SARI base URL (both local on RStudio/Docker or remote on Shinyapps) will start a new SARI session, automatically upload and plot the <em>SPOTGINS</em> GNSS position series of the station <em>CRAL00FRA</em> from the <em>FORMATERRE</em> server, and also the <em>NGL</em> <em>IGS14</em> series of the station <em>CRAL</em> as secondary series (see the <a href="#iii.-ancillary-information"><a href="#ancillary-information" target="_self">Ancillary information</a></a> block).<br />
This feature allows webmasters of any GNSS series database to include a link on their webpages so that users can open a specific GNSS series directly with SARI on a new browser tab. Contact the <a href="#author"><a href="#author" target="_self">author</a></a> for more information.
<p>
</p>
<p>At this moment, the following servers and products are available:</p></li>
</ol>
<table style="width: 100%">
<colgroup>
<col span="1" style="width: 6%;">
<col span="1" style="width: 4%;">
<col span="1" style="width: 21%;">
<col span="1" style="width: 4%;">
<col span="1" style="width: 60%;">
</colgroup>
<thead>
<tr>
<th style="text-align:left; border-bottom: 1px solid black">
Server
</th>
<th style="text-align:left;">
</th>
<th style="text-align:left; border-bottom: 1px solid black"">Station</th>
<th style="text-align:left;">
</th>
<th style="text-align:left; border-bottom: 1px solid black"">Product</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
LOCAL
</td>
<td style="text-align:center;">
<sup>1</sup>
</td>
<td style="text-align:left;">
file path
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
ENU, NEU, PBO, NGL, SPOTGINS, 1D
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="http://renag.resif.fr/en/" target="_blank">RENAG</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
4 characters (TLSE)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
UGA
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://en.poleterresolide.fr/" target="_blank">FORMATERRE</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
9 characters (TLSE00FRA)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
SPOTGINS_POS, UGA_POS
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://www.epos-eu.org/" target="_blank">EPOS</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
9 characters (TLSE00FRA)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
INGV, SGO-EPND, UGA-CNRS, ROB-EUREF
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://www.sonel.org/" target="_blank">SONEL</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
9 characters (TLSE00FRA)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
ULR7A
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://igs.org/products/" target="_blank">IGS</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
4 characters (TLSE)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
IGS20
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://epncb.eu/_organisation/about.php" target="_blank">EUREF</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
9 characters (TLSE00FRA)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
IGB14
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="http://geodesy.unr.edu/" target="_blank">NGL</a>
</td>
<td style="text-align:center;">
<sup>2</sup>
</td>
<td style="text-align:left;">
4 characters (TLSE)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
IGS20, IGS14, RAPID
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://sideshow.jpl.nasa.gov/post/series.html" target="_blank">JPL</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
4 characters (TLSE)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
REPRO2018A
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://www.earthscope.org/" target="_blank">EARTHSCOPE</a>
</td>
<td style="text-align:center;">
<sup>3</sup>
</td>
<td style="text-align:left;">
4 characters (TLSE)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
CWU, PBO, NMT
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://www.sirgas.org/en/" target="_blank">SIRGAS</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
4 characters (TLSE)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
IGB14
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://ids-doris.org/" target="_blank">DORIS</a>
</td>
<td style="text-align:center;">
<sup>4</sup>
</td>
<td style="text-align:left;">
4 characters (TLSB)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
ESA, GOP, GRG, GSC, IDS, IGN
</td>
</tr>
<tr style="vertical-align: top">
<td style="text-align:left;">
<a href="http://loading.u-strasbg.fr/" target="_blank">EOSTLS</a>
</td>
<td style="text-align:center;">
<sup>5</sup>
</td>
<td style="text-align:left;">
14 characters (TLSE_10003M009)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
ATMIB, ATMIB(d), ATMMO(o), ECCO(o), ECCO2, ERA5IB, ERA5IB(d), ERA5TUGO, ERA5TUGO(d), ERA5HYD, ERA5HYD(d), ERA5LAND, GRACE, GLDAS2, GLDAS2(d), GLORYS(o), MERRA2ATM, MERRA2ATM(d), MERRA2HYD, MERRA2HYD(d)
</td>
</tr>
<tr style="vertical-align: top">
<td style="text-align:left;">
<a href="https://psmsl.org/" target="_blank">PSMSL</a>
</td>
<td style="text-align:center;">
</td>
<td style="text-align:left;">
Station number
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
RLR
</td>
</tr>
</tbody>
</table>
<p></br></p>
<p>Notes:<br />
<sup>1</sup> The <em>LOCAL</em> server is used only to upload series from local files on a local SARI session (more details in the <a href="https://github.com/alvarosantamariagomez/sari/blob/main/scripts/sari.sh">SARI shell script</a>).<br />
<sup>2</sup> The <em>RAPID NGL</em> series correspond to the IGS14 solution.<br />
<sup>3</sup> The EarthScope (UNAVCO) series correspond to the <em>IGS14</em> solution.<br />
<sup>4</sup> The DORIS series correspond to the <em>25wd01</em> solution.<br />
<sup>5</sup> The <em>EOSTLS</em> loading series are those computed in the center of figure (CF) frame. <b><span style="color: #DF536B;">WARNING:</span></b> some of the <em>EOSTLS</em> series are very long and/or have a very high sampling, loading these series may take longer than expected. It is recommended to use the daily series from those products marked with <em>(d)</em>, if they are available. Products marked with <em>(o)</em> represent old products that are no longer updated.</p>
<p>Contact the <a href="#author"><a href="#author" target="_self">author</a></a> if more servers or products need to be added.</p>
<p>When uploading a series from a remote server via the the <code>server</code>, <code>product</code> and <code>station</code> options, SARI will also upload the corresponding <em>sitelog</em>, <em>soln.snx</em> or <em>custom offset</em> files, depending on the selected server, if these files are available for the selected station (see the <a href="#iii.-ancillary-information"><a href="#ancillary-information" target="_self">Ancillary information</a></a> block).</p>
Once uploaded and plotted (see the <a href="#ii.-plot-controls"><a href="#plot-controls" target="_self">Plot controls</a></a> block), the series will be shown on the visualization panel on the right. If the series contains three coordinate components (all except the <em>1D</em> format), the three coordinate components of the series will be shown together in the <em>3D</em> tab. Each coordinate component will be also available individually in separate tabs on the top. The series analysis is done separately for each coordinate component in its respective tab (see the <a href="#ii.-fit-controls"><a href="#fit-controls" target="_self">Fit controls</a></a> block).<br />
In case the coordinate components are not known to SARI, the tabs will be labeled : 1st, 2nd and 3rd component, respectively.
<p>
</p>
When plotting a primary and a secondary series with different formats, the option <code>N@E</code> can be activated to match the coordinate components North and East of the secondary series with respect to those of the primary series (see the <a href="#iii.-ancillary-information"><a href="#ancillary-information" target="_self">Ancillary information</a></a> block).
<p id="series-id">
</p>
For GNSS time series, the station ID is extracted from the first characters of the input file name and will be shown in the <code>series ID</code> box under the loaded series. The station ID can be modified by the user if necessary. For more information on the use of the station ID, see the <a href="#iii.-ancillary-information"><a href="#ancillary-information" target="_self">Ancillary information</a></a> block. For other type of series, this feature can be neglected.
<p id="average">
</p>
It is possible to average and reduce the sampling of the input series, for instance from daily values to weekly, by using the <code>reduce sampling</code> option. The user needs to provide the new sampling period in the same time units of the series. This option also accepts expressions identified by a starting <em>=</em>, such as <em>=7/365.25</em> for transforming a daily sampling into weekly sampling using year time units.<br />
If high-frequency data are not needed, averaging the series will save a lot of time when fitting models, finding discontinuities or when estimating the colored noise in the series (see the <a href="#v.-additional-fit"><a href="#additional-fit" target="_self">Additional fit</a></a> block).<br />
If the series was computed with a constant integration period, like the common 24 h in GNSS position series, this option is useful to transform daily GNSS series with irregular sampling into daily GNSS series with regular sampling, i.e., points separated by exactly 24 h, except when data gaps exist.<br />
If there were points already removed from the series before reducing the sampling, these points will not contribute to the new averaged values. Also, if there is a secondary series being used with the <code>correct</code> or <code>average</code> options, the reduced sampling will be obtained before the secondary series is used. This means that the primary and secondary series would be compared after their original sampling has been reduced.
<p id="map">
</p>
<p>A summary of the contents of the plotted series (number of points, time range, sampling, etc.) will be shown at the bottom of this block.<br />
If the station coordinates are already known, or provided by the user, the <code>show location map</code> option will show a map with the station’s location together with the <a href="#references"><a href="#references" target="_self">Bird (2003)</a></a> plate boundaries. The station ID and the plate name are shown by hoovering over the map.</p>
<h3 id="plot-controls">
</h3>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h2 id="ii.-plot-controls">II. Plot controls</h2>
<p>This block allows working with the plots of the time series.</p>
<p>Once the format of the series is set, they can be plotted or resetted with the <code>plot</code> and <code>reset</code> buttons, respectively. The <code>reset</code> button will also remove the uploaded series and any other information given by the user (see the <a href="#interactive-operation"><a href="#interactive-operation" target="_self">Interactive operation</a></a> section).</p>
The button <code>overview</code> opens a new browser window containing a static PNG figure with the series of the three coordinate components taking into account the current state of the series (zoom, removed points, plate motion correction and fitted model). If the series have been fitted, this figure will also include the estimated linear trend and the standard deviation of the model residuals for each fitted component.<br />
There is no need to close and reopen the <code>overview</code> window, if the windown is left open (for instance, on a second screen), the PNG figure will update automatically each time there is a change in the series or in their fitting.
<p id="cut">
</p>
The <code>truncate</code> option allows removing the beginning and/or end of the series up to/from a given time epoch. The epochs must be given in the same time units as those selected for the series (see the <a href="#input-format"><a href="#input-format" target="_self">Input data and format</a></a> section).
<p id="strip">
</p>
The <code>remove period</code> option allows removing all the points inside the given <em>from</em> and <em>to</em> epochs. The epochs must be given in the same time units of the series.
<p id="threshold">
</p>
Outliers selected manually can be excluded from the analysis with the <code>toggle</code> option. Outliers can also be excluded automatically with the <code>auto toggled</code> button after providing a residual threshold or a normalized residual threshold (i.e., times above the error bar, if provided).<br />
The <code>reset toggle</code> button restores at once all the points that were previously toggled.<br />
See more details about removing/restoring points in the <a href="#interactive-operation"><a href="#interactive-operation" target="_self">Interactive operation</a></a> section.
<p id="3d">
</p>
The <code>all components</code> option changes between removing outliers for each coordinate component independently or from all components simultaneously. This option works also when analyzing different columns using the 1D series format.
<p id="permanent">
</p>
The <code>permanent</code> option will permanently delete the next points to be toggled/truncated from the series. Permanently means the selected points cannot be restored back and they will not be shown again in the current session. This option is intended, for instance, to remove extreme outliers that do not allow visualizing the series correctly.<br />
The original series file is not modified and can be reloaded to use all the points again, after resetting the current session with the <code>reset</code> button. The <code>permanent</code> option is deactivated by default, and once one or more points are toggled/truncated in a single action, it will automatically deactivate itself so the next points to be toggled/truncated will be available to be restored. When toggling/truncating points that were already removed, this option will delete them permanently as well, instead of restoring them.
<p id="excluded">
</p>
The <code>include in file</code> option will keep the excluded outliers in the downloaded results file as commented lines. No fitting values will be provided for these points.
<p id="scrolling">
</p>
<p>The <code>scrolling</code> option enables/disables the vertical scrolling of the left panel. By default the scrolling is enabled. When disabling it, the user will be able to take a screenshot of the full web page with the plots and all the input parameters that were used to make the plots, which is very convenient for sharing and archiving a specific analysis, making reports or marking assignments. The quality of the full page screenshot may depend on the browser/extension used.</p>
<p>Alternatively, the user can download the full SARI interface from the web browser (usually by pressing Ctrl+s) into an HTML file together with the corresponding web files in a separate directory having a similar name. The downloaded HTML file represents a frozen SARI session (i.e., not connected to the server) that can be reopened later on the web browser even offline. The advantage of the HTML page compared to the fixed screenshot is that all the numeric values are available to be selected and copied, so the same analysis can be easily replicated in a live session. However, before opening the HTML file in a web browser, it needs to be modified first. The shell script <a href="https://github.com/alvarosantamariagomez/sari/blob/main/scripts/SARIwebpage.sh">SARIwebpage.sh</a> does the modifications automatically.<br />
Note: Unfortunately, at this moment, the values of the UI interface, including the options selected by the user, are only saved in the HTML file when using Mozilla Firefox. Other web browsers, like Safari and the Google Chromium family (Google Chrome, Microsoft Edge and Opera), do not keep this information when saving the web page.</p>
<h3 id="ancillary-information">
</h3>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h2 id="iii.-ancillary-information">III. Ancillary information</h2>
<p>This block allows for the uploading of files containing complementary information related to the analysis of GNSS position time series. When an ancillary file is uploaded, the file contents can be visualized in a new browser tab by clicking on the link at the right of each input file.<br />
The user can upload any combination of the following possibilities:</p>
<ul>
<li>a file with the LS or KF model parameters from a previously saved SARI file</li>
<li>a GNSS <em>sitelog</em> file (an example of this file can be found <a href="https://github.com/alvarosantamariagomez/sari/blob/main/www/iraf00fra_20201021.log">here</a>)</li>
<li>a GAMIT-like <em>station.info</em> file (an example of this file can be found <a href="https://github.com/alvarosantamariagomez/sari/blob/main/www/station.info">here</a>)</li>
<li>an IGS-like soln discontinuity file (an example of this file can be found <a href="https://github.com/alvarosantamariagomez/sari/blob/main/www/soln.snx">here</a>)</li>
<li>a customized offset file to plot specific dates (for instance, earthquakes)</li>
<li>a secondary series that can be <code>shown</code> next to the primary series in green color for comparison purposes and detection of common features, or used to either <code>correct</code> the primary series to analyze the difference or <code>average</code> both the primary and secondary series values. For instance, a model can be subtracted a posteriori from the series (loading, post-seismic, etc.) or even the series of a nearby station in order to remove the spatially correlated signal/noise and better detect the individual equipment changes, relative motion or common variations (see the <a href="#notes-on-the-secondary-series"><a href="#notes-on-the-secondary-series" target="_self">notes</a></a> below).</li>
<li>a plate motion model to be <code>shown</code> on top of the horizontal component series or <code>removed</code> from the series. The user needs to select a plate motion model from the dropdown menu and enter the name of a tectonic plate, or provide a custom plate motion model for the current series, or provide the parameters of the <a href="https://en.wikipedia.org/wiki/Euler%27s_rotation_theorem">Euler’s pole</a> manually (see the <a href="#notes-on-the-plate-motion-model"><a href="#notes-on-the-plate-motion-model" target="_self">notes</a></a> below).</li>
<li>a vertical land motion prediction from a <a href="https://en.wikipedia.org/wiki/Post-glacial_rebound">GIA</a> model to be <code>shown</code> on top of the vertical component series or <code>removed</code> from the series (see the <a href="#notes-on-the-gia-model"><a href="#notes-on-the-gia-model" target="_self">notes</a></a> below).</li>
</ul>
<h5 id="notes-on-the-equipment-change-logs">
</h5>
<h5 id="notes-on-the-equipment-change-logs"><strong>Notes on the equipment change logs</strong>:</h5>
<ol type="1">
<li>The <em>sitelog</em>, <em>station.info</em>, <em>soln</em> and <em>customized</em> files can be uploaded to list/plot equipment changes and help identify position discontinuities. Antenna changes are represented by solid lines. Receiver and other changes represented by dashed lines. Each type of file has a different line color: <em>sitelog</em> in blue, <em>station.info</em> in pink, <em>soln</em> in gray, <em>customized</em> in cyan.<br />
</li>
<li>The dates from the <em>sitelog</em>, <em>station.info</em> and <em>soln</em> files will be transformed according to the time unit selected for the series. If the time unit is days, the dates will be transformed into <a href="https://en.wikipedia.org/wiki/Julian_day">Modified Julian Days</a>. If the time unit is weeks, the dates will be transformed into <a href="https://en.wikipedia.org/wiki/GPS_week_number_rollover">GPS weeks</a>.<br />
</li>
<li>The station ID (see the <a href="#i.-input-data-and-format"><a href="#input-format" target="_self">Input data and format</a></a> block) will be used to extract the information from the <em>station.info</em>, <em>soln</em>, <em>customized offset</em>, and <em>plate motion</em> files. The user is responsible for checking that the station(s) in these files actually correspond to the same station ID being used (many GNSS stations around the world share the same ID).<br />
</li>
<li>The <em>customized offset</em> file must contain one or two columns separated by spaces or tabulations. The first column contains the date in the same time units as the input series. The second column is optional and contains the station ID. If the second column is present, only the dates corresponding to the current station ID will be extracted. If the second column is missing, all the dates in the file will be used. A warning will be shown if the file contains more than two columns.<br />
</li>
<li>As an exception, the discontinuities file from the <a href="https://geodesy-plotter.ipgp.fr/data/SPOTGINS/formater_offset.dat">Geodesy Plotter</a> and from the <a href="http://geodesy.unr.edu/NGLStationPages/steps.txt">Nevada Geodetic Laboratory</a> can be uploaded directly as a <em>customized offset</em> file without changing their format.</li>
</ol>
<h5 id="notes-on-the-secondary-series">
</h5>
<h5 id="notes-on-the-secondary-series"><strong>Notes on the secondary series</strong>:</h5>
<ol type="1">
<li>The <em>secondary series</em> can be obtained from a single file or from several files uploaded at the same time. When uploading several files, they will be added together to form a single <em>secondary series</em>. For instance, atmospheric, oceanic and hydrological loading series at the same site can be uploaded at the same time to obtain a single <em>secondary series</em> representing the total loading at the site.<br />
</li>
<li>When loading several files, only the common epochs among them will be retained. If one epoch is missing in one of the files, it will be skipped.<br />
</li>
<li>Several loading products can be selected and uploaded directly from the EOSTSL server (see the <a href="#iii.-input-format"><a href="#input-format" target="_self">Input data and format</a></a> block). If necessary, the series are automatically resampled to daily before being added together to form the <em>secondary series</em>. Change the averaging period of the <em>secondary series</em> to obtain a different sampling (e.g., weekly or monthly). The recommended loading models (J-P. Boy, personal communication) are: atmospheric loading from the latest ECMWF ERA5 reanalysis including the dynamic ocean response from the TUGO-m barotropic model (ERA5TUGO(d) label) together with hydrology loading (soil moisture and snow) from the ERA5-Land reanalysis (ERA5LAND label). More details at the <a href="http://loading.u-strasbg.fr">EOSTLS server</a>.<br />
</li>
<li>If several <em>secondary series</em> are uploaded manually by the user, the series are added together as they are provided, so it is the user’s reponsability to verify that they have consistent time units and sampling.<br />
</li>
<li>The <code>Swap</code> button exchanges the role of the <em>primary</em> and <em>secondary series</em> so that the <em>secondary series</em> can be now analysed as if it was loaded as the <em>primary series</em>. Both the <em>primary</em> and <em>secondary series</em> will be reset to their original values, i.e., neglecting any resampling, excluded points or plate motion corrections.<br />
</li>
<li>When uploading a <em>secondary series</em>, both station IDs will be shown in the <code>series ID</code> box on the left panel, together with a “&amp;” when using the option <code>show</code>, a “–” when using the option <code>correct</code>, a “:” when using the option <code>average</code>, or a “+” when using the option <code>merge</code>. When the <em>primary series</em> is combined with a <em>secondary series</em> (using <code>correct</code>, <code>average</code>, or <code>merge</code>, but not <code>show</code>), the IDs from both series will be extracted from the <em>station.info</em>, <em>soln</em>, and <em>customized offset</em> files. Otherwise only the ID from the primary series will be used.<br />
</li>
<li>If the <code>show</code> option is selected, the <em>secondary series</em> will be plotted in green on the right y-axis and will not be included in the processing. This means that the <em>secondary series</em> could have a different sampling than the <em>primary series</em>. In case the <code>correct</code> or the <code>average</code> option is selected, only the common epochs between the <em>primary</em> and the <em>secondary series</em> will be shown. In the latter case, the <em>secondary series</em> must have observations at common epochs with the <em>primary series</em> because the series are neither filled nor interpolated at common epochs. For the <code>merge</code> option, only the epochs that are present in the <em>secondary series</em> and not in the <em>primary series</em>, will be added to the <em>primary series</em>.<br />
</li>
<li>When the <em>primary series</em> is combined with a <em>secondary series</em> using any of the <code>correct</code>, <code>average</code>, or <code>merge</code> options, both the <code>plate model</code> and <code>GIA model</code> options will be disabled and fixed to their current status. This is done to avoid using these model corrections before and also after the <em>primary</em> and <em>secondary series</em> were combined. The <code>plate model</code> and <code>GIA model</code> options must be used before combining the <em>primary</em> and <em>secondary</em> series.<br />
</li>
<li>For typical GNSS series with daily sampling, even if the sampling period is constant, very often the epochs will not exactly match between the <em>primary</em> and <em>secondary series</em>, especially if the series are produced by different people. If the <em>primary</em> and <em>secondary</em> series have both a constant sampling of one day, but their epochs do not match, SARI will try to compute the constant fraction of a day shift between both series and apply it to the <em>secondary series</em> to match the epochs of the <em>primary series</em>. This feature will only work correctly if both the <em>primary</em> and <em>secondary</em> series have a regular sampling, independently of their time unit.<br />
</li>
<li>If the <em>secondary series</em> does not have the same sampling as the <em>primary series</em>, a warning will be shown on screen. The sampling of the <em>secondary series</em> can be reduced with the <code>averaging</code> option, which is equivalent to the <code>reduce sampling</code> option of the <em>primary series</em> (see the <a href="#iii.-input-format"><a href="#input-format" target="_self">Input data and format</a></a> block).<br />
</li>
<li>For NEU/ENU series, the <em>secondary series</em> must have the same format than the <em>primary series</em>. For 1D series, the user has the option to choose the column number and column separator for the <em>secondary series</em> independently of those already set for the <em>primary series</em>.<br />
</li>
<li>The units of the <em>secondary series</em> can be scaled using the <code>scale factor</code> option. Also the y-axis values of the <em>secondary series</em> are partially controlled by the <code>same scale</code> and <code>same axis</code> options with respect to the left y-axis of the <em>primary series</em>. The <code>same scale</code> option will force the right y-axis to have the same range as the left y-axis, but not necessarily the same values. The <code>same axis</code> option will force the right y-axis to be the same as the left y-axis.<br />
</li>
<li>The <code>full series</code> option will expand the plot area to show both the <em>primary</em> and <em>secondary series</em>. By default, the plot are only includes the <em>primary series</em>.<br />
</li>
<li>If the coordinate components of either the <em>primary</em> or the <em>secondary</em> series are unknown, the <code>N@E</code> option can be used to swap the North and East components of the <em>secondary series</em> to match the components of the <em>primary series</em>.</li>
</ol>
<h5 id="notes-on-the-plate-motion-model">
</h5>
<h5 id="notes-on-the-plate-motion-model"><strong>Notes on the plate motion model</strong>:</h5>
<ol type="1">
<li>In order to compute the <em>plate motion</em>, SARI needs to know the station coordinates and the parameters of the Euler’s pole. The station coordinates will be extracted automatically from <em>NGL</em>, <em>PBO</em> and some <em>ENU/NEU</em> series. For other series formats, the Cartesian (X,Y,Z) or geographic (latitude, longitude) coordinates of the station must be provided below the <code>select a plate model</code> option in this section. The units of the Cartesian station coordinates must be the same as the time series units (i.e., meters or millimeters). If geopraphic coordinates are provided and the <code>Series units</code> have not been set, SARI will try to guess if the values of the GNSS series are in meters or millimeters and then transform the geographic coordinates into Cartesian coordinates with the correct units. This guess may fail if the series are ambiguous, so either the series units must be set by the user or the station Cartesian coordinates should be preferred as input.<br />
</li>
<li>The <code>Select a plate model</code> option allows selecting any of the three <em>plate motion</em> models implemented in SARI: the ITRF2020 model (<a href="#references"><a href="#references" target="_self">Altamimi et al. 2023</a></a>), the NNR-MORVEL56 model (<a href="#references"><a href="#references" target="_self">Argus et al. 2011</a></a>) and the NNR-GSRM v2.1 model (<a href="#references"><a href="#references" target="_self">Kreemer et al. 2014</a></a>). The parameters of the Euler’s pole for each plate can be shown by clicking on the <code>Show the selected plate model</code> link. The user needs to select a plate motion model and then select one of the tectonic plates available for each model.<br />
</li>
<li>Alternatively, the user can <code>Upload a custom plate model</code> that must have six or seven values per line corresponding to the station ID (first value), the station coordinates (two values: latitude &amp; longitude; or three values: X,Y,Z), and the Euler’s pole parameters (three values: latitude,longitude,rotation or X,Y,Z rotations). If a station ID is present in more than one line, only the last one will be used. The units of the plate model parameters are degrees for latitude &amp; longitude and degrees/Ma for rotations. An example of the custom <em>plate motion</em> model can be found <a href="https://github.com/alvarosantamariagomez/sari/blob/main/www/euler.txt">here</a>).<br />
</li>
<li>Once the <em>plate motion</em> model is read, the extracted values will be shown on the left panel. The user can check and modify these values manually. If no values are being shown, it means no values were found for either the selected plate (see point 2) or the current station ID (see point 3) that is shown in the <code>station ID</code> box of the left panel.<br />
</li>
<li>The <code>plate model</code> option will be disabled and fixed to their current status (<em>none</em>, <em>show</em> or <em>remove</em>) if both the <em>primary</em> and <em>secondary series</em> are combined using any of the <code>correct</code>, <code>average</code>, or <code>merge</code> options. This is done to avoid using the <code>plate model</code> correction before and also after the <em>primary</em> and <em>secondary series</em> were combined. The <code>plate model</code> option must be used before combining the <em>primary</em> and <em>secondary</em> series.</li>
</ol>
<h5 id="notes-on-the-gia-model">
</h5>
<h5 id="notes-on-the-gia-model"><strong>Notes on the GIA model</strong>:</h5>
<ol type="1">
<li>The vertical land motion (VLM) linear trend value is extracted by bilinear interpolation of the station’s location (also for the secondary series) on the selected model grid.</li>
<li>The available GIA VLM grids are obtained from the <a href="#references"><a href="#references" target="_self">Caron and Ivins, 2019</a></a> model with resolution 1°x1° (using the total mass sources), the ICE-6G-VM5a model with resolution 0.2°x0.2° (version D, <a href="#references"><a href="#references" target="_self">Peltier et al., 2018</a></a>) and the ICE-6G-ANU model with resolution 1°x1° (<a href="#references"><a href="#references" target="_self">Purcell et al., 2016</a></a>).</li>
<li>The station coordinates must be provided in the plate motion model section (see the <a href="#notes-on-the-plate-motion-model"><a href="#notes-on-the-plate-motion-model" target="_self">notes</a></a> above).</li>
<li>The extracted VLM value can be modified manually to change the sign, for instance if correcting the VLM of a TG series, or to use a different VLM value, for instance obtained from a GNSS series.<br />
</li>
<li>The <code>GIA model</code> option will be disabled and fixed to their current status (<em>none</em>, <em>show</em> or <em>remove</em>) if both the <em>primary</em> and <em>secondary series</em> are combined using any of the <code>correct</code>, <code>average</code>, or <code>merge</code> options. This is done to avoid using the <code>GIA model</code> correction before and also after the <em>primary</em> and <em>secondary series</em> were combined. The <code>GIA model</code> option must be used before combining the <em>primary</em> and <em>secondary</em> series.</li>
</ol>
<h3 id="fit-controls">
</h3>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h2 id="iv.-fit-controls">IV. Fit controls</h2>
<p>This block allows fitting a model to each one of the coordinate component series using</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Weighted_least_squares">Weighted least squares (LS)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Extended_Kalman_filter">First-order extended Kalman filter/smoother (EKF)</a></li>
<li><a href="https://en.wikipedia.org/wiki/Kalman_filter#Unscented_Kalman_filter">Unscented Kalman filter/smoother (UKF)</a></li>
</ul>
<p>The <code>Select model components</code> option allows defining the fitted deterministic model by including any combination of linear trend, higher-degree polynomial, offsets/discontinuities, sinusoidal signals, exponential and logarithmic decays.</p>
Some of these components require additional parameters to be included in the model (e.g., reference epochs, periods, a priori values, etc.). The reference epochs and the a priori values can be left empty and SARI will use some reasonable values automatically. Note that the a priori values can have a strong impact on the quality of non-linear fits, for example the exponential and logarithmic decays (see the <a href="#notes-on-the-exponential/logarithmic-decay-fitting"><a href="#notes-on-the-exponential/logarithmic-decay-fitting" target="_self">notes</a></a> below).<br />
Additionally, if using a <em>KF</em> fit, the initial state and the standard deviation of the process noise can be set for the trend and sinusoidal components (see the <a href="#notes-on-the-kalman-filter"><a href="#notes-on-the-kalman-filter" target="_self">notes</a></a> below).
<p id="notes-on-the-model-breaks">
</p>
<p>If using a <em>LS</em> fit, the <code>segmented model</code> option allows fitting the linear rate, sinusoidal and polynomial components to different segments of the series, which are defined by a comma-separated list of <em>break epochs</em>. If the input list of <em>break epochs</em> is not empty, a new option allows fitting a <em>continuous</em> or <em>segmented</em> linar rate, sinusoidal variation or higher-degree polynomial. In case the <em>continuous</em> option is selected, the break epochs will be ignored for a specific component. For instance, a continuous sinusoidal variation can be fitted together with a segmented linear rate, or vice versa. In case the <em>segmented</em> option is selected, the estimated model components will not be constrained between the different segments.</p>
<p>The fitted model will be represented by a red line on top of the original series and in the plot of the residuals with a zero value line.<br />
The <code>click and collect</code> option allows adding the epochs of the clicked points on the series plots automatically to the list of offset epochs in the fitted model.<br />
The fitted offsets will be represented by vertical red lines in the residual plot.</p>
<p>A fit summary will be shown on the visualization pannel on the right.<br />
In case of a <em>LS</em> fit, the summary includes the estimated values of the chosen model components, their formal uncertainty, their absolute <a href="https://en.wikipedia.org/wiki/Student%27s_t-test">Student’s t-test</a> statistic and their corresponding significance level, i.e., the probability of rejecting a true null hypothesis in which the parameter value is not significantly different from zero; in short, the probability that the model parameter is unnecessary. Probabilities higher than 5 % will be printed in red as a warning. The correlation between the model parameters is also provided on the visualization panel. Similarly, correlations higher than 0.8 will be printed in red as a warning.<br />
The LS fit also prints the estimated “residual standard error” value, which, in this context, represents the unitless scale factor that was applied to the series error bars to obtain the residual error bars. Values higher/lower than 1 ususally indicate that the series error bars are too optimistic/pesimistic to represent the unexplained variability of the series themselves.<br />
In case of a <em>KF</em> fit, the summary will include the statistics (mean value, standard deviation, etc.) for each model component included in the estimated state.</p>
<p>When the three coordinate components are fitted (excludig 1D series), the tab <em>residuals</em> will appear at the top. This tab will show the plots of the three coordinate components, as in the 3D tab, but using the fit residual series. By comparing the three residual series at the same time, it should be easier to verify the general quality of the fit. The <code>save</code> button will download the three residual series into a single file.</p>
<p>The <code>search discontinuities</code> button provides an automatic guesstimate of the location of probable discontinuities in the time series. The algorithm is based on the assessment of deviations from stability in different segments of the series using a classical linear regression model and a <a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion">Bayesian Information Criterion</a> (BIC). The algorithm is described by <a href="#references"><a href="#references" target="_self">Zeileis et al. (2003)</a></a>. <b><span style="color: #DF536B;">WARNING:</span></b> this option is very time-consuming (see the <a href="#notes-on-the-discontinuity-detection"><a href="#notes-on-the-discontinuity-detection" target="_self">notes</a></a> below).</p>
<h5 id="notes-on-the-kalman-filter">
</h5>
<h5 id="notes-on-the-kalman-filter"><strong>Notes on the Kalman filter</strong>:</h5>
<ol type="1">
<li>The EKF/UKF fits include both the forward Kalman filter and the backward Kalman smoother using the <a href="https://en.wikipedia.org/wiki/Kalman_filter#Rauch%E2%80%93Tung%E2%80%93Striebel">Rauch-Tung-Striebel</a> (RTS) algorithm. Only the smoothed solution is kept.<br />
</li>
<li>The UKF implementation is described by <a href="#references"><a href="#references" target="_self">Julier and Uhlmann (2004)</a></a> and the unscented RTS smoother is described by <a href="#references"><a href="#references" target="_self">Särkkä (2008)</a></a>.<br />
</li>
<li>The KF fit does not include any dynamics (i.e., control inputs) and assumes additive, independent measurement and process noises; the latter for the trend and the sinusoids only. The measurement noise is time invariant, unless the series error bars are in use. In that case, the relative change of the error bars is used to scale the measurement noise. The average of the actual measurement noise level used for the entire series will correspond to the measurement noise value indicated on the left panel. Data gaps are also accounted for by increasing the process noise through the missing observations.<br />
</li>
<li>The user can set the expected (average) measurement noise level and the initial values and uncertainties of the state for all the parameters being fitted or leave them blank. In the latter case, some values will be proposed. Note that the filter output strongly depends on all the provided initial values. For instance, an extremely small initial uncertainty on a parameter would “fix” it to its initial value; which is useful when we know precisely the magnitude of a discontinuity, for instance.<br />
</li>
<li>The measurement and process noise levels need to be provided with respect to the series sampling that is being used in the fit, which is indicated on the left panel at the bottom of the <a href="#i.-input-data-and-format"><a href="#input-format" target="_self">Input data and format</a></a> block.<br />
</li>
<li>The <code>compute measurement noise</code> option will provide the most likely measurement noise level, within some bounds provided by the user, and with respect to the process noise also provided by the user. This is done through a maximum likelihood optimization of a preliminary UKF fit with respect to the provided process noises for the trend and sinusoids only. The optimization uses the <a href="#references"><a href="#references" target="_self">Brent (1971)</a></a> method, and it may take up to ~20 iterations of a standard UKF fit. The 95 % confidence interval of the estimated measurement noise standard deviation will be shown next to the input bounds on the left panel.<br />
</li>
<li>The process noise values for the trend and sinusoidal variations are zero by defaul. Any positive value will make these parameters to change with time. When fitting a time-variable trend, a plot below the residual series will show the time series of the estimated time-variable trend, which is useful to assess whether the filter is too smooth or not, especially if other parameters were fitted together with the rate.<br />
</li>
<li>When fitting a time-variable sinusoid, there is an option to apply the process noise to the sine component (S) only or to both the sine and cosine (C) components independently. The first option will capture amplitude variations, but also phase and maybe even frequency variations. The second option may only capture amplitude variations, but this is not guaranteed as the estimates of the sine and cosine terms are not constrained to vary the same amount.<br />
</li>
<li>Due to the KF fit being slower than the LS fit (see details in the <a href="#known-issues"><a href="#known-issues" target="_self">Known issues</a></a> section), the user has to set all the parameters of the filter first and then push the <code>run KF</code> button. This way, the filter is run once and not each time one of the parameters is changed, as for the LS fit. The parameters left blank will be completed automatically (at the user’s risk).<br />
</li>
<li>If the user has fitted the same model with LS before fitting it with the KF, some of the LS-estimated values will be used as the initial state for the KF.</li>
</ol>
<h5 id="notes-on-the-sinusoidal-fitting">
</h5>
<h5 id="notes-on-the-sinusoidal-fitting"><strong>Notes on the sinusoidal fitting</strong>:</h5>
<ol type="1">
<li>By default, the reference epoch of the sinusoidal fitting is the mean of the available measurement epochs, and phase values are estimated accordingly.<br />
</li>
<li>The sinusoidal model is linearized by separating it into sine and cosine components. The estimated sinusoidal amplitude and phase, including their formal uncertainty, are provided below the correlations of the fitted parameters in the fit summary of the right panel.<br />
</li>
<li>The convention for the sinusoidal phase is that the sine component is positive clockwise.</li>
<li>Below the option to enter the <code>sinusoidal periods</code>, the <code>draconitic harmonics</code> option automatically adds 4 overtones of the <a href="https://en.wikipedia.org/wiki/Orbital_period#Draconic_period">draconitic orbital period</a> for each selected GNSS constellation. Choose the constellation(s) that was used to compute the position time series. The number of draconitic harmonics can be modified in the <code>sinusoidal periods</code> input.</li>
</ol>
<h5 id="notes-on-the-exponential/logarithmic-decay-fitting">
</h5>
<h5 id="notes-on-the-exponentiallogarithmic-decay-fitting"><strong>Notes on the exponential/logarithmic decay fitting</strong>:</h5>
<ol type="1">
<li>The expected exponential/logarithmic decay fit corresponds to that commonly observed in some GNSS position time series due to visco-elastic deformation from post-seismic or surface mass loading phenomena. The decay is assumed to be asymptotic towards a more recent date and lasts for several years. The internal algorithm computes its own a priori values based on this assumption, but the user is free to provide their own a priori values when fitting a different decay.<br />
</li>
<li>The success in fitting an exponential/logarithmic decay depends heavily on the quality of the a priori values for the asymptotic offset and the decay rate parameters. If the user does not provide these a priori values, a built-in algorithm provides a heuristic guess. The quality of this guess depends on the amount of data available shortly after the start of the decay and whether the series contains other components that may alter the decay, such as discontinuities, trends, periodic variations, or noise. Data gaps can be particularly problematic for accurately guessing the a priori values. If a data gap occurs at the beginning of the decay, masking the epoch of start, it is recommended to set the reference epoch of the decay right before the first available observation and estimate a position offset at this epoch.<br />
</li>
<li>For each decay being fitted in the series, if any of the a priori values for the asymptotic offset and the decay rate is empty or deleted by the user, the built-in algorithm will kick off and update both values with its own guess.<br />
</li>
<li>If more than one model component is occurring simultaneously (e.g., a position offset with an exponential decay or an exponential decay with a logarithmic decay), the quality of the guessed a priori parameter values may be poor because they are obtained independently for each decay.<br />
</li>
<li>If the a priori parameter values are not accurate enough, the fitting may provide unsatisfactory results or even fail. In this case, the a priori parameter values can be manually tuned on the left panel using an educated or an eyeball guess. For instance, the exponential/logarithmic asymptotic offset corresponds to the observed difference between the series value at the start of the decay and the asymptotic value (the asymptotic offset is positive if the series is decreasing for the exponential and increasing for the logarithmic). If the decay complies with the expected behavior in GNSS (see point 1 of these notes), the decay rate should be positive. For the exponential, it is roughly the time taken to reduce the asymptotic offset to one-third of its value; for the logarithmic, the decay rate can be challenging to guess accurately.<br />
</li>
<li>If more than one decay (exponential, logarithmic or mixed) is being fitted, and the a priori values for one of them are changed (improved), it may cause the fitting to fail. This is because the a priori values left unchanged for the other decay may now be worse than before, i.e., with respect to what remains to be fitted.<br />
</li>
<li>Finally, bear in mind that even if the epoch of an earthquake is precisely known, down to the minute or even the second, a GNSS time series is a discrete series computed very often out of daily batches. This means the discontinuity may appear in the GNSS series at the daily batch boundaries and not at the earthquake epoch itself. If the discontinuity epoch is not correctly set with respect to the discrete series, i.e. at the epoch of the observed discontinuity, that may be slightly different than the one from the earthquake, the fitting of the post-seismic relaxation may provide bad results or even fail. Excluding the GNSS estimate of the day of the earthquake may be enough to fix this problem.</li>
</ol>
<h5 id="notes-on-the-discontinuity-detection">
</h5>
<h5 id="notes-on-the-discontinuity-detection"><strong>Notes on the discontinuity detection</strong>:</h5>
<ol type="1">
<li>The success of the automatic detector improves when any systematic variation in the series is removed beforehand, such as trends, periodics, decays, outliers. Therefore, the detector can only be applied to residual series. The user can even remove some discontinuities before running the detector or remove &amp; run it several times as it may detect new discontinuities when the residual series flattens.<br />
</li>
<li>The automatic detector has difficulties in detecting discontinuities when approaching the beginning and the end of the series. To minimize this limitation, the series is automatically padded with random white noise at both ends (only for the automatic detection run). However, this may sometimes provide false positives extremely close to the beginning or end of the series due to an unwanted change in the local mean value within the padded values. The user should be suspicious of these positives unless they are significant and really evident.<br />
</li>
<li>The user can set the minimum length of the segments considered in the stability test, which is 10% of the series length by default. However, it must be large enough to include at least three observations. The length of the segments will impact the number of discontinuities found and the processing time, which increases inversely proportional to the segment length. The processing time also depends on the number of observations. Therefore, do not hesitate to <code>reduce the sampling</code> as necessary (see the <a href="#i.-input-data-and-format"><a href="#input-format" target="_self">Input data and format</a></a> block). Additionally, discontinuities are often easier to find in downsampled (filtered) series.<br />
</li>
<li>The epochs of the detected discontinuities (if any) are displayed on the left panel. The user can copy and paste the epochs into the model components to remove them. Note that in case the series are auto-correlated, the detected discontinuities could be caused by random non-zero mean noise fluctuations (see the <a href="#notes-on-the-offset-verification"><a href="#notes-on-the-offset-verification" target="_self">notes on the offset verification</a></a> below).<br />
</li>
<li>Using 75 synthetic series from the RENAG “DOGEX” experiment (from Stephane Mazzotti), the automatic detector performed as good as my own eyes for low noise series (horizontal components). However, manual detection was still much better for noisy series (vertical component).</li>
</ol>
<h5 id="notes-on-the-offset-verification">
</h5>
<h5 id="notes-on-the-offset-verification"><strong>Notes on the offset verification</strong>:</h5>
<ol type="1">
<li>Spurious discontinuities of unknown origin (i.e., no recorded GNSS equipment changes or earthquakes) may appear in series containing time-correlated noise. The corresponding estimated offsets may be considered statistically significant if the series is assumed uncorrelated. This happens in the implemented LS fitting and when using the <em>automatic discontinuity detection</em>.<br />
</li>
<li>To cope with this situation, the user has the option to verify the significance of the estimated offsets against time correlation in the series provided by a power-law noise process, which is the most common in GNSS position series.<br />
</li>
<li>The parameters of the power-law noise process must be provided from a priori knowledge or estimated with the <code>Noise analysis</code> option (see the <a href="#v.-additional-fit"><a href="#additional-fit" target="_self">Additional fit</a></a> block). In case a noise analysis was already run, the estimated noise values will be included automatically in the offset verification section.<br />
</li>
<li>In the offset verification run, a <a href="https://en.wikipedia.org/wiki/Likelihood-ratio_test">Generalized Likelihood Ratio test</a> is used to compare the (log-)likelihood of the residual series (offsets removed) being produced by the provided noise model compared to the (log-)likelihood of the series with each one of the estimated offsets restored back individually. The higher the likelihood ratio, the greater the chances a particular offset is likely not being produced by random noise fluctuations.<br />
</li>
<li>The significance of each estimated offset is provided on the left panel based on the probability of a centred chi-squared distribution. Usually, only offsets with a probability higher than 95 % should be retained in the fitted model. Otherwise, there are chances that the estimated offsets may be generated by random noise instead of being systematic changes.</li>
</ol>
<h3 id="additional-fit">
</h3>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h2 id="v.-additional-fit">V. Additional fit</h2>
<p>This block allows for additional time series fitting, including:</p>
<ul>
<li>An automatic linear trend estimator using the Median Interannual Difference Adjusted for Skewness (MIDAS) algorithm (<a href="#references"><a href="#references" target="_self">Blewitt et al. 2016</a></a>). Depending on the linearity of the time series, this algorithm provides reasonable and robust linear trend estimates in the presence of position discontinuities in the series (see the <a href="#notes-on-the-midas-trend-estimates"><a href="#notes-on-the-midas-trend-estimates" target="_self">notes</a></a> below).<br />
</li>
<li>A pseudo-automatic linear trend estimator using the minimum entropy method. This option provides reasonable linear trend estimates in the presence of near-stationary unknown colored noise, if the epochs of the discontinuities in the series are provided (see the <a href="#notes-on-the-minimum-entropy"><a href="#notes-on-the-minimum-entropy" target="_self">notes</a></a> below).<br />
</li>
<li>The histogram of the original, model, residual or smoothed series with its expected normal distribution (red curve) and a stationarity assessment using the <a href="https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test">Augmented Dickey-Fuller</a> and the <a href="https://en.wikipedia.org/wiki/KPSS_test">Kwiatkowski-Phillips-Schmidt-Shin</a> tests.<br />
</li>
<li>A non-parametric <a href="https://en.wikipedia.org/wiki/Waveform">waveform</a> for studying periodic patterns in the residual series not having a sinusoidal shape. The waveform is plotted in red as if it were part of the fitted model (see the <a href="#notes-on-the-waveform"><a href="#notes-on-the-waveform" target="_self">notes</a></a> below).<br />
</li>
<li>The amplitude or power spectrum from the weighted <a href="https://en.wikipedia.org/wiki/Least-squares_spectral_analysis">Lomb-Scargle</a> periodogram of the original data, the fitted model, the model residuals, the smoothed values, or the smoother residuals. These five spectra can be plotted and compared against each other (see the <a href="#notes-on-the-periodogram"><a href="#notes-on-the-periodogram" target="_self">notes</a></a> below).<br />
</li>
<li>A pseudo discrete <a href="https://en.wikipedia.org/wiki/Wavelet_transform">wavelet transform</a> analysis for irregularly sampled time series described in <a href="#references"><a href="#references" target="_self">Keitt (2008)</a></a> and available for the original data, the fitted model, the model residuals, the smoothed values, or the smoother residuals. <b><span style="color: #DF536B;">WARNING:</span></b> this option is very time-consuming (see the <a href="#notes-on-the-wavelet-transform"><a href="#notes-on-the-wavelet-transform" target="_self">notes</a></a> below).<br />
</li>
<li>The <a href="#references"><a href="#references" target="_self">Vondrák (1977)</a></a> band-pass smoother to reduce the variability around chosen periods from uneven, unfilled, uninterpolated, and uncertain sampled observations or evenly sampled observations with gaps and varying error bars. The smoother can be applied either to the original series or to the residual series from the model fit. It is plotted in yellow in both the series and residual plots (see the <a href="#notes-on-the-vondrak-smoother"><a href="#notes-on-the-vondrak-smoother" target="_self">notes</a></a> below).<br />
</li>
<li>A noise analysis to estimate the full variance-covariance matrix that best describes the model/filter residuals as a Gaussian process by means of an <a href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation">MLE</a> of the parameters of a chosen covariance model. <b><span style="color: #DF536B;">WARNING:</span></b> this option can be very time-consuming (see the <a href="#notes-on-the-noise-analysis"><a href="#notes-on-the-noise-analysis" target="_self">notes</a></a> below).</li>
</ul>
<h5 id="notes-on-the-midas-trend-estimates">
</h5>
<h5 id="notes-on-the-midas-trend-estimates"><strong>Notes on the MIDAS trend estimates</strong>:</h5>
<ol type="1">
<li>The algorithm was implemented based on the description by <a href="#references"><a href="#references" target="_self">Blewitt et al. (2016)</a></a> and using Geoff Blewitt’s code available <a href="ftp://gneiss.nbmg.unr.edu/MIDAS_release">here</a>.<br />
</li>
<li>Only data pairs strictly separated by one year (within a tolerance of half a day) are used in the computation.<br />
</li>
<li>Contrary to the original algorithm, the estimated velocity uncertainties are not scaled.<br />
</li>
<li>Outliers removed from the series will not be considered in the selected data pairs, which is useful when having periodic outliers, for instance due to snow/ice on the GNSS antenna.<br />
</li>
<li>If the user removes discontinuities from the series, two MIDAS estimates will be provided: with and without the interannual differences crossing the discontinuities. The latter is the one that should be considered. Both estimates are provided so the user can assess the level of robustness of the trend estimate when the algorithm is applied blindly with series having known discontinuities, but not removed, or having unknown discontinuities, i.e., not recorded in any discontinuity database.<br />
</li>
<li>The histogram of the selected interannual trends (discontinuities skipped) is also displayed to provide a qualitative assessment of the MIDAS estimate.</li>
</ol>
<h5 id="notes-on-the-minimum-entropy">
</h5>
<h5 id="notes-on-the-minimum-entropy-trend-estimates"><strong>Notes on the minimum entropy trend estimates</strong>:</h5>
<ol type="1">
<li>The method provides the linear trend that minimizes the <a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)">Shannon entropy</a> of the detrended series, i.e., the linear trend that maximizes the predictability of the series. The entropy is approximated by the non-parametric Vasicek estimator based on sample-spacings defined by a window size.<br />
</li>
<li>The implemented algorithm is based on the one proposed by <a href="#references"><a href="#references" target="_self">Saleh et al. (2024)</a></a>. The main deviations of the algorithm include an adaptive window size and the estimated velocity uncertainty that accounts for the number and location of the discontinuities.<br />
</li>
<li>At this moment and because of position discontinuities, the algorithm samples a wide range of possible velocity values with a reasonably high resolution and provides the one with the highest score. In the future, a more efficient algorithm could make use of an optimization method to find the solution faster by minimizing the amount of sampled values.<br />
</li>
<li>The algorithm assumes long, near-stationary and <a href="https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables">iid</a> residual series, which is rather difficult to satisfy with typical GNSS position series. Nevertheless, it seems to provide reasonable linear trend estimates with realistic uncertainties in the presence of unknown colored noise, as long as the noise remains near-stationary, which may be roughly assessed using the <code>histogram</code> and <code>periodogram</code> options.<br />
</li>
<li>The algorithm is robust against a few outliers and short-period oscillations. However, the epochs of the discontinuities, if any, must be indicated by the user. The algorithm estimates the weighted sum of the entropy for each segment between discontinuities.<br />
</li>
<li>If there are discontinuities already used in a LS fit, they will be automatically included in the entropy estimate. If there is no LS fit or there are missing discontinuities in the LS fit, the user can indicate the epochs of the discontinuities under the <code>entropy</code> option on the left panel.<br />
</li>
<li>The discontinuity epochs provided for the entropy estimate will not be used in the LS fit, but any discontinuity in the LS fit will be used in the entropy estimate.</li>
</ol>
<h5 id="notes-on-the-waveform">
</h5>
<h5 id="notes-on-the-waveform"><strong>Notes on the waveform</strong>:</h5>
<ol type="1">
<li>The non-parametric waveform is estimated by averaging the model or smoother residual series on coincident epochs within the period defined by the user. The series must be stationary, so this feature can only be applied to residual series (assuming they are near stationarity). For unevenly sampled series, the waveform is approximated by averaging almost coincident epochs into small bins around typical epochs. This is neccesary when the time unit is years and the series sampling is in days, as commonly found in GNSS series. In this case, non-coincident observation epochs are unavoidable due to the fact that the Earth’s orbital period is not a multiple of the Earth’s rotation period. Note that epochs or epoch bins containing few averaged values may provide a biased value of the waveform for that epoch, for instance with extremely uneven sampling.<br />
</li>
<li>Contrary to the sinusoidal fit, the non-parametric waveform can take any shape. On the other hand, it will not be defined by an analytical expression. Neverthelesss, the waveform can still be used to predict unobserved series like data gaps or past/future observations.<br />
</li>
<li>By default, the estimated waveform will be added to the fitted model, or smoothed series, and will be subtracted from the residual series for visualization purposes, without actually modifying the original series when saving the results. The estimated waveform series will be saved in a separated column of the downloaded file.<br />
</li>
<li>The waveform is estimated from the residual series and, by default, it will not affect the fitted model parameters unless the <code>remove from series</code> option is activated. In this case, the estimated waveform will be extracted from the original series before the model fit, affecting the estimated model parameters. This modification of the original series can be undone by deactivating the <code>remove from series</code> option. Note that any modification of the model components or the original/residual series (i.e., outliers) will imply deactivating the <code>remove from series</code> option automatically.</li>
</ol>
<h5 id="notes-on-the-periodogram">
</h5>
<h5 id="notes-on-the-periodogram"><strong>Notes on the periodogram</strong>:</h5>
<ol type="1">
<li>The amplitude spectrum is useful for quickly assessing the amplitude of the different sinusoidal peaks that may compose the series. The power spectrum is similar, but in squared units, and it is useful for quickly assessing the auto-correlation of the series.<br />
</li>
<li>The <em>oversampling period</em> and both the <em>max/min periods</em> to be estimated can be set by the user. The period units are the same as the series time units. The frequency resolution of the periodogram is set as the inverse of the maximum period divided by the oversampling value. By default, there is no oversampling applied, i.e. unity value. The larger the number of periods to estimate, the longer it will take to estimate the periodogram. Generally, it should be computed reasonably fast unless the user asked for a very large number of periods, for instance, from long series with high sampling.<br />
</li>
<li>With no input from the user, the <em>maximum period</em> and a reasonable <em>minimum period</em> will be provided. The minimum period is based on the assumption that observations are already integrated over a constant observing period given by the most frequent time spacing in the series. This pseudo-Nyquist period should be fine for regular sampling with gaps, as in a typical GNSS position series.<br />
</li>
<li>In case the series are made up of instantaneous observations (or that could be considered instantaneous) with uneven sampling, rather than being integrated over an observing period, the actual Nyquist period exists even for extremely uneven series and can be much shorter than the typical/average sampling of the series, as proposed by <a href="#references"><a href="#references" target="_self">Eyer and Bartholdi (1999)</a></a>. It is the user’s responsibility to verify and set the minimum period that would allow recovering the maximum of frequency information from the series.<br />
</li>
<li>The user can zoom in on an area of the periodogram (see details in the <a href="#interactive-operation"><a href="#interactive-operation" target="_self">Interactive operation</a></a> section) and increase the <em>oversampling</em> to get a better resolution of the amplitude/power distribution around specific periods. Note that “better resolution” could be misleading here as there is no new (i.e., independent) information being included in the periodogram when the <em>oversampling</em> is increased; the periodogram looks just smoother. If a zoom was applied, the periodogram will be recomputed with the new oversampling for the selected area only, which saves processing time by reducing the number of periods to compute. The <em>maximum</em> and <em>minimum</em> periods of the new periodogram will change on the left panel. To compute the full periodogram again, the user must delete one of the <em>maximum</em> or <em>minimum</em> periods, and the full range will be used again. It is recommended to set the <em>oversampling</em> back to 1 (default) before computing the full periodogram again.<br />
</li>
<li>The implemented algorithm forces the integral of the power spectrum to equal the total variance of the observed series. That is, this is a different normalization compared to the standard Lomb-Scargle periodogram. This allows for a more intuitive and direct comparison of the power spectrum of the different series (e.g., original vs filtered).<br />
</li>
<li>In both the amplitude and power spectra, if the user clicks on the periodogram, the coordinates (period &amp; amplitude/power) of the clicked point will be shown under the plot together with those of the closest estimated period; the latter point will be marked on the periodogram plot. In addition, if no oversampling is applied (unity value), the scatter (standard deviation) of the series integrated up to the clicked period will also be shown under the plot. For instance, if the user clicks at the longest period of the series or beyond, and the computed periodogram includes all possible periods, the obtained value will nearly correspond to the standard deviation of the series.<br />
</li>
<li>In case the power spectrum is selected, two lines will pe plotted on top of the periodogram: a pink dashed line representing the slope of a pure flicker noise process commonly seen in residual GNSS series, and a solid line with the same color as the periodogram itself representing the average slope of the rightmost type of periodogram selected amongst the five options (original, model, residuals, etc.). These lines should help the user to roughly assess the level of time correlation of the series. However, if the user runs a <code>Noise analysis</code>, the power spectrum of the estimated noise model will be plotted instead of the aforementioned lines. This will help the user to assess the quality of the estimated noise model and to assess the crossover period between the components of the noise model (if more than one).<br />
</li>
<li>If the user wants to use the <code>Noise analysis</code> option to fit a power-law noise model, it is highly recommended to compute the power spectrum of the residual series first. This is because the MLE optimization will use the power spectrum slope as the a priori value for the power-law spectral index and, in many cases, this is a reasonably good a priori value that may speed up the MLE fit.</li>
</ol>
<h5 id="notes-on-the-wavelet-transform">
</h5>
<h5 id="notes-on-the-wavelet-transform"><strong>Notes on the wavelet transform</strong>:</h5>
<ol type="1">
<li>The wavelet transform is based on the inner product of the selected series and the scaled and translated complex-valued <a href="https://en.wikipedia.org/wiki/Morlet_wavelet">Morlet wavelet</a> with a central frequency equal to 2<span class="math inline"><em>π</em></span> radians.<br />
</li>
<li>The user needs to set the <em>max/min periods</em>, the <em>period resolution</em>, and the <em>temporal resolution</em> (all in the same time units of the series). The max/min periods and the highest period resolution will be proposed when the user activates the wavelet option. These are based on the equivalent periodogram limits. A reasonable temporal resolution will also be initially provided, roughly corresponding to 500 epochs regularly distributed along the series length. Note that the minimum period and the temporal resolution must be set consistently in order to get a correct decomposition of the signal at high frequency.<br />
</li>
<li>The plotted gray dashed line represents the cone of influence of the transform, i.e., for long periods outside this line, edge effects may bias the transform. The solid black lines represent the 1<span class="math inline"><em>σ</em></span>, 2<span class="math inline"><em>σ</em></span> and 3<span class="math inline"><em>σ</em></span> values of magnitude (assuming they are normally distributed). The solid black asterisk represents the location of the maximum magnitude.<br />
</li>
<li>Compared to the periodogram or the KF, the maximum period estimated by the wavelet transform corresponds to half the observed series. In addition, even if results are obtained from unevenly spaced series, data gaps will still seriously affect the wavelet transform. Also, the estimated magnitude is not exactly comparable to a sinusoidal amplitude; the estimated magnitude can deviate from a sinusoidal amplitude by up to 5% (estimated empirically, further testing to be done).<br />
</li>
<li>Computing the wavelet decomposition at full resolution can be horribly time-consuming. A warning will be shown on the screen with a rough estimate of the time it may take. If the expected computation time is too long, it is recommended to start with a lower temporal and/or spectral resolution to get a generalized idea of the heat map. Then the user can iteratively improve the resolution as needed and at the same time reducing the max/min periods to focus on areas of interest in order to save time.<br />
</li>
<li>The time needed to compute the wavelet transform is commensurate with the amount of server memory used. Since the online server memory is limited and shared among simultaneous users (see details in the <a href="#known-issues"><a href="#known-issues" target="_self">Known issues</a></a> section), large wavelets may not finish, or even the server could kill the user’s session, if there is not enough free memory. Unfortunately, this happens without any warning.</li>
</ol>
<h5 id="notes-on-the-vondrak-smoother">
</h5>
<h5 id="notes-on-the-vondrák-smoother"><strong>Notes on the Vondrák smoother</strong>:</h5>
<ol type="1">
<li>The smoother acts as a <a href="https://en.wikipedia.org/wiki/Band-pass_filter">band-pass filter</a> and accepts two input periods: a <em>low-pass</em> and a <em>high-pass</em> cut-off. To smooth the variability between these two periods, input the cut-off period values as <span class="math inline"><em>l</em><em>o</em><em>w</em> <em>p</em><em>a</em><em>s</em><em>s</em> &gt; <em>h</em><em>i</em><em>g</em><em>h</em> <em>p</em><em>a</em><em>s</em><em>s</em></span>. On the other hand, to smooth everything outside a selected band, swap the cut-off values and set <span class="math inline"><em>h</em><em>i</em><em>g</em><em>h</em> <em>p</em><em>a</em><em>s</em><em>s</em> &gt; <em>l</em><em>o</em><em>w</em> <em>p</em><em>a</em><em>s</em><em>s</em></span>.<br />
</li>
<li>If the <em>low-pass</em> or the <em>high-pass</em> period is left blank, the smoother will react as a high-pass or a low-pass filter, respectively.<br />
</li>
<li>The cutoff period of the smoother is only approximate and depends on the number of points in the series. An empirical scaling has been applied to the algorithm, but there may still be a bias between the user input cut-off period and the smoother cut-off response. Fortunately, this bias is constant for each series. Therefore, the bias, if any, can be assessed and taken into account by the user by looking at the intersection between the periodograms of the filter series and the filter residual series.<br />
</li>
<li>Since it is based on cubic splines, the quality of the Vondrák smoother may degrade very close to the data limits at the start and end of series, but also near long data gaps and discontinuities.<br />
</li>
<li>If the band to be smoothed is narrow, a significant amount of signal will remain in the series. This is due to the relatively slow “spectral response” of the smoother, which is slightly worse than a Hanning window (Sylvain Loyer, personal communication).<br />
</li>
<li>The effect of filtering the series inside/outside the specified band can be assessed by plotting the periodogram of the filter and the filter residuals, or by using the wavelet transform.<br />
</li>
<li>If the series are fitted by an LS or KF model, the residual plot will show the differences between the smoothed series and the fitted model in yellow color. If there is no LS or KF model, the residual plot will show the smoother residuals.</li>
</ol>
<h5 id="notes-on-the-noise-analysis">
</h5>
<h5 id="notes-on-the-noise-analysis"><strong>Notes on the noise analysis</strong>:</h5>
<ol type="1">
<li>The noise analysis is applied to the residual series from the model fit or from the Vondrák filter. In case both series exist, the priority is given to the model residuals.<br />
</li>
<li>The covariance model can be created from four stochastic processes commonly seen in GNSS position time series: <a href="https://en.wikipedia.org/wiki/White_noise">white noise</a>, <a href="https://en.wikipedia.org/wiki/Flicker_noise">flicker noise</a>, <a href="https://en.wikipedia.org/wiki/Brownian_noise">random walk noise</a> and <a href="https://en.wikipedia.org/wiki/Colors_of_noise#Power-law_noise">power-law noise</a>.<br />
</li>
<li>The power-law noise is a generalization of the other three noise processes and, thus, it is not possible to estimate power-law with other colored noise such as flicker or random walk, but it is compatible with white noise, though.<br />
</li>
<li>The user needs to select the components of the noise model among the four proposed and SARI will provide the more likely values of the parameters of those components (noise standard deviation and spectral index). The estimated log-likelihood can be used to assess which noise model is more likely to fit the residual series better. The power spectrum of the residual series can also be used to visually assess whether the estimated noise model is a reasonable fit of the series covariance.<br />
</li>
<li>After the MLE fit, the left panel will contain the estimated standard deviation of each noise process, given in <span class="math inline"><em>s</em></span> <span class="math inline"><em>t</em><sup><em>k</em>/4</sup></span> units, where <span class="math inline"><em>s</em></span> ant <span class="math inline"><em>t</em></span> are the <code>Series units</code> and the <code>Time units</code>, respectively, and <span class="math inline"><em>k</em></span> is the spectral index: <em>0</em> for white noise, <em>-1</em> for flicker noise, <em>-2</em> for random walk noise. If the <code>Noise uncertainty</code> option was selected, the estimated formal errors will also be shown. The formal errors of the noise parameters can be used to assess whether a noise component was clearly detected in the optimization process.<br />
</li>
<li>A priori values of the noise parameters are computed assuming they all contribute equally to the series variance, except for the a priori RW variance which is kept minimum. The a priori value of the spectral index for the power-law model is that of a flicker noise model, but a better a priori value can be used if the power spectrum of the residual series has been computed (see the <a href="#notes-on-the-periodogram"><a href="#notes-on-the-periodogram" target="_self">notes</a></a> above).<br />
</li>
<li>Several optimization methods have been implemented, both constrained and unconstrained. At this moment, SARI only uses the unconstrained quasi-Newton method proposed by <a href="#references"><a href="#references" target="_self">Schnabel et al (1985)</a></a>, which was found to be the fastest among those tested.<br />
</li>
<li>The processing time of the <em>noise analysis</em> grows considerably for long series with high sampling and complex noise models. An estimate of the expected processing time will be shown on the screen, based on the number of points in the series and the chosen noise model. Note that the expected time is only approximate, as it depends on how well the requested noise model fits the series and on the CPU used for the computations. The expected times shown on screen are those for a typical online SARI session, where a WN+PL model fit to a fifteen-year-long daily series will take more than 10 minutes. Using SARI on a local session should produce faster noise analyses than the online sessions, where resources are shared among users, even CPU in case of many simultaneous users (see details in the <a href="#known-issues"><a href="#known-issues" target="_self">Known issues</a></a> section). For local sessions, compiling the source code of the necessary R packages on a Linux machine may produce significant gains of processing time, somewhere around 10 times faster, compared to installing the package binaries on a Windows machine. In addition, for local sessions on a Windows machine, there are optional packages that, when installed, would speed up the noise analysis significantly (see details in the <a href="https://github.com/alvarosantamariagomez/sari/blob/main/INSTALL">INSTALL</a> instructions file). There is still room for optimization of the code in future versions, but at this moment, for online SARI sessions, it is recommended to reduce the sampling of the series to the minimum necessary. For instance, the periodogram can be used to assess the period from which the power-law noise starts dominating the variance and then adjust the sampling of the series to half that period; the white noise will be mostly averaged out. For GNSS position time series, a weekly sampling is a reasonable choice. In that case, even a WN+PL model fit (or PL only actually) to a 34-year weekly series on an online session should take less than 1 minute to finish.<br />
</li>
<li>For noise models that include more than one component, the uncertainty of the estimated parameters is obtained from a numerical approximation of the <a href="https://en.wikipedia.org/wiki/Hessian_matrix">Hessian</a> of the log-likelihood. If the series is very long, computing the Hessian numerically can take a significant amount of time, so if the uncertainties of the noise parameters are not needed, deactivating the option <code>Noise uncertainty</code> will skip this computation and speed up the noise analysis. For noise models with a single component, the Hessian of the likelihood can be obtained analytically and very quickly, so the <code>Noise uncertainty</code> option will not be available (uncertainty of the noise component computed by default).<br />
</li>
<li>The <code>Noise separation</code> option uses the <a href="https://en.wikipedia.org/wiki/Wiener_filter">Wiener filter</a> to decompose the residual series into several noise component series following the relative variance-covariance contribution of each estimated noise component. The estimated noise series are printed to the downloaded results file.<br />
</li>
<li>The LS model fit is not updated with the estimated covariance matrix of the residuals. However, if the fitted LS model includes a linear trend, an approximation of its formal uncertainty is provided by taking into account the estimated colored noise. This is done using the general formula for the uncertainty in the rate for a power-law noise from <a href="#references"><a href="#references" target="_self">Williams (2003)</a></a>. The estimated rate uncertainty from the noise analysis is then included into the linear trend uncertainty.<br />
</li>
<li>The ratio of the linear trend uncertainty (colored vs. white estimates) is also displayed on the left panel. This parameter represents a rough estimate of the amount of colored noise accounted for by the fitted noise model and can be used to compare different noise models. Note that the white noise uncertainty used in this ratio is estimated separately and does not necessarily correspond to the standard LS trend uncertainty, which includes the effect of the fitted model and especially the offsets. In other words, if the fitted LS model has many offsets, the colored noise might actually not contribute significantly to the linear trend uncertainty already provided by the LS fit.<br />
</li>
<li>If the power spectrum of the model residual or filter residual series is plotted, the power spectrum of the fitted noise model will be drawn on top of it. The crossover periods between the different noise components (if there is more than one noise component) will be shown on the left panel.<br />
</li>
<li>The estimated noise parameters will be used automatically in the <code>Check offsets</code> option to assess the statistical significance of the estimated offsets in a LS fit (see the <a href="#iv.-fit-controls"><a href="#fit-controls" target="_self">Fit controls</a></a> block).</li>
</ol>
<hr />
<h1 id="interactive-operation">
</h1>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h1 id="interactive-operation">Interactive operation</h1>
<p>The top navigation bar contains the links to this <em>help page</em> and for changing between the 3D, the different coordinate components and the residual series (unless a 1D series is used). It also contains two links at the right edge to download this help page into a <code>PDF</code> file and to <code>save</code> the results of the analysis. These two links will not be visible unless they are needed. To get back to the main program interface from this help page, click on any of the coordinate component tabs.</p>
<p>SARI processes the time series of each coordinate component independently. However, many options and features activated while analyzing the series in one of the tab/components will still be active when changing the tab/component (if using a 3D series) or the column number (if using a 1D series). This implies that when changing the series component, the visualization of the new series will not be available until all the selected features are computed. This allows fitting the same model for different components of the series or different series in the same input file, although it may also slow down the initial visualization of the series. It is recommended to deactivate the options that are not needed to have a faster and smoother transition between coordinate components. Also, bear in mind that a model that has been adjusted in one series may fail for another (for instance, if fitting a logarithmic/exponential decay). Since the Kalman filter is run only when clicking on the <code>run KF</code> button, the KF fit will be removed when changing the tab.</p>
<p>One click on any plot will provide the coordinates of the clicked point in a space right under the plots. This is useful to obtain the series values, pinpoint discontinuity epochs, or periodic lines in the spectrum. Note that in case a secondary series is plotted, the coordinates of the clicked point will correspond to the vertical axis of the primary series on the left, which very likely, will be different to the axis of the secondary series on the right, unless the <code>same axis</code> option is activated (see the <a href="#notes-on-the-secondary-series"><a href="#notes-on-the-secondary-series" target="_self">notes on the secondary series</a></a>).</p>
<p>One click and drag will select an area on any plot. Once the area is selected, its dimensions and location can be modified. One click outside the area will remove the selection. A double click inside the area of any plot will zoom in on the selection. A double click on the same plot with no selected area will zoom out (if possible) to the original view.<br />
Points inside the red selected area on the series plot (top) or the blue selected area on the model/filter residuals plot (bottom) can be excluded using the <code>toggle points</code> button. This is useful for removing outliers or for limiting the series to a period of interest (see the <code>truncate</code> option for that also). The removed points will turn into solid red on the series plot as a remainder, but they will disappear on the model/filter residual plot. If the option <code>permanent</code> is activated, the toogled points will be removed from the analysis for good (but not from the user input file). If the series has more than one dimension, the removed points for each dimension will be kept separately when changing tabs if the <code>all components</code> option is not activated.<br />
Any point toggled twice on the series plot (top) will be restored as a valid point again, i.e., off and on, unless the the option <code>permanent</code> was used. All <em>toggled</em> points in the tab can be restored at once with the <code>reset toggle</code> button. If the <code>reset toggle</code> button is not active, it means there are no points to be restored.</p>
<p>When points are removed from the series after fitting a KF, the fit results will still be available for the remaining points, but these results will not represent the actual series after the points were removed. This is because the KF is updated only when the <code>run KF</code> button is clicked (see the <a href="#iv.-fit-controls"><a href="#fit-controls" target="_self">Fit controls</a></a> block). A warning asking to run the KF again will be shown on the screen.<br />
For the same reason, when previously removed points are included back again into the series (restored) after fitting a KF, since there is no solution estimated for these points, the full KF results will be deleted and the user will have to run the KF again.</p>
<p>In addition to using the selected areas on the plots, large residuals can be automatically excluded using the <code>auto toggle</code> button. Large is defined by providing the absolute <em>residual threshold</em> or the absolute <em>normalized residual</em>, i.e., the residual divided by its own error bar if available. All the points outside the absolute thresholds will be excluded at once.</p>
<p>The <code>reset</code> button will erase all the plots and all the parameters from the server memory, except the pointer to the <em>station.info</em> and the <em>custom offset</em> files, which will remain ready to be used again (even if they may not appear as being uploaded, the <code>plot</code> and <code>list</code> options will still be available).<br />
After finishing a series and before uploading a new one, it is recommended to click the <code>reset</code> button instead of refreshing the page.</p>
<p>Some features require intensive and time-consuming processing (<em>noise analysis</em>, <em>automatic offset detection</em>, <em>wavelet</em>). In order to save server resources and make the app always accessible to anyone, after 15 minutes without client-server interaction, the server will kill the connection, go to sleep, and may even dream of electric sheep like all androids surely do!<br />
A warning should appear on the screen when a very long computation time is expected.</p>
<hr />
<p id="example-use">
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h1 id="example-of-use">Example of use</h1>
<p>This is how I usually estimate the linear trend in a GNSS position time series (the steps may change depending on the series and application):</p>
<ol type="1">
<li>Upload the series file from your computer using the <code>browse file</code> button, or from a remote web server using the <code>Server</code>, <code>Product</code> and <code>Station</code> options, or via a URL query, or from a Unix-like terminal using the <a href="https://github.com/alvarosantamariagomez/sari/blob/main/scripts/sari.sh">sari.sh script</a>.<br />
</li>
<li>If loading a series from your computer, set the series format and time units if they are not already set, and <code>Plot</code> the series with points (default), lines or points &amp; lines.<br />
</li>
<li>Click on the <code>overview</code> button to open a new window with the three coordinate components and then select one of the coordinate components in the upper tabs. Move the overview window to a secondary screen and leave it open there.<br />
</li>
<li>Load and correct one of the available <code>plate models</code> (for horizontal components) and <code>GIA models</code> (for the vertical component) if necessary. The station’s tectonic plate can be obtained with the <code>show location map</code> option. You can also load the parameters of your own plate and GIA models.<br />
</li>
<li>Upload a secondary series to correct the loading displacements (atmospheric, oceanic and hydrology) using the series available at the EOSTLS server.<br />
</li>
<li>If the series is very long (more than 10 years) and it has daily sampling, reduce it to weekly sampling using the <code>reduce sampling</code> option with a period of <em>=7/365.25</em> years (or the equivalent 7 days or 1 week, depending on the series time unit).<br />
</li>
<li>Upload a previously unfinished fit or the fit from another series, if comparison is needed, with the <code>load SARI model</code> button.<br />
</li>
<li>Upload the <em>sitelog</em> and/or <em>station.info</em> and/or <em>soln</em> and/or <em>custom offset</em> files from your computer if available. The <em>station.info</em> and <em>custom offset</em> files are already loaded if you have done this and did not refresh the page.<br />
</li>
<li>Show the equipment changes by activating <code>plot changes</code> next to the input <em>sitelog</em>, <em>station.info</em>, <em>soln</em> and/or <em>custom</em> files.<br />
</li>
<li>Fit a low-pass <code>smoother</code> (a period of 0.1 years should be enough to fit seasonals) and remove the outliers from the filter residuals manually using the <code>toggle points</code> button, or automatically using a residual threshold and the <code>auto toggle</code> button. Activate the <code>all components</code> option before removing any outlier if you want to have the same points removed from the three coordinate components. If you need to keep track of the removed points, activate the <code>include in file</code> option. If any of the points is extremely far from the series and does not allow visualizing them correctly, remove them right after activating the <code>permanent</code> option.<br />
</li>
<li>Remove the low-pass smoother (optional) and fit a linear trend using weighted LS.<br />
</li>
<li>Fit position discontinuities due to known equipment changes (dates are available by activating <code>list</code> changes next to the input <em>sitelog</em>, <em>station.info</em> and/or <em>custom</em> files) or due to unknown events (dates are available under the plot by zooming in and clicking where a discontinuity is needed).<br />
</li>
<li>Alternatively, if feeling lazy today, you can also try to <code>search discontinuities</code> automatically (this is very time-consuming, so do not forget to reduce the sampling to weekly).<br />
</li>
<li>Plot the power <code>periodogram</code> of the model residuals and look for significant periodic lines.<br />
</li>
<li>Remove sinusoidal variations and check the periodogram. The exact periods can be obtained by zooming in and clicking on the periodogram. Rise the oversampling factor after zooming in if necessary, but return to 1 before zooming out. If the periodic variations are not sinusoidal, use the generic <code>periodic waveform</code> instead of the LS sinusoidal fit. If the periodic variations are sinusoidal, but their amplitude and/or phase are changing smoothly, use a Kalman filter fit with appropriate process and measurement noise variances. Temporal changes of amplitude and frequency can be assessed using the <code>wavelet</code> analysis (this is very time-consuming, so you may need to reduce the period bounds and/or reduce the temporal/frequency resolution of the wavelet).<br />
</li>
<li>Add logarithmic and/or exponential terms to the fitted model if necessary. Add also a higher-degree polynomial in the extremely unlikely case that this could be explained from a geophysical point of view.<br />
</li>
<li>Iterate the steps 11 to 15 while zooming in and out guided by the smoother, the known equipment changes, the other coordinate components shown in the overview window, an independent deformation model, or the series of a nearby station, which can be uploaded with the <em>secondary series</em> option (only if loading corrections were not already uploaded in step 4).<br />
</li>
<li>Check the Student’s t-test of significance for each one of the fitted model parameters in the fit summary (bearing in mind that formal errors may be too optimistic) and remove unnecessary discontinuities from the model.<br />
</li>
<li>When the fit of the LS model is finished, run the <code>noise analysis</code> using a white + power-law noise model to get a better formal rate uncertainty (this can be very time-consuming, so do not forget to reduce the sampling to weekly if necessary).<br />
</li>
<li>Check the power <code>periodogram</code> (from step 13) to validate that the fitted noise model corresponds to the LS model residuals, or use the estimated log-likelihood to select the best noise model. The parameters of the fitted noise model will be used to estimate a more realistic formal uncertainty of the linear trend.<br />
</li>
<li>Use the estimated noise parameters to iteratively check the significance of the estimated offsets using the <code>check offsets</code> option and remove offsets from the LS model one by one if their probability is less than 95 %.<br />
</li>
<li>Plot the <code>histogram</code> if statistics of the model residuals or a stationarity assessment are needed. The standard deviation of the residuals is also indicated on the overview figure.<br />
</li>
<li>Run the <code>MIDAS</code> and/or the <code>minimum entropy</code> estimators for trend comparison.<br />
</li>
<li>Save the results of each coordinate component on your computer using the <code>save</code> icon at the top right corner. This file can be uploaded with the <code>load SARI model</code> if you need to redo the same fit later. If necessary, the periodogram data can be saved by clicking on the <code>get periodogram data</code> link below the periodogram.<br />
</li>
<li>Iterate through the different coordinate components and save each one of them. The same component can be saved multiple times, for instance if the model was improved. You can also save a full-page screenshot with all the plots and analysis results. To do that it is recommended to deactivate the <code>scrolling</code> option first.<br />
</li>
<li>When all the coordinate components are done, click on the <em>residuals</em> tab and check if anything else is missing in the fit. Check the residual series and the fitted series in the overview window side to side. If all is good, click on the <code>save</code> button to download the residual series into a file.</li>
<li>Right click on the <code>overview</code> window and save the PNG figure to be used later in a presentation or in the supplemental material of a paper.</li>
<li>Click on the <code>reset</code> button before starting a new series and enjoy!</li>
</ol>
<p>Do not refresh the page unless you encountered a problem, in which case, I would be interested in knowing more about it.</p>
<hr />
<h1 id="known-issues">
</h1>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h1 id="known-issues">Known issues</h1>
<p>There is a finite number of simultaneous connections that can be run by the online server at Shinyapps. That number depends on the user load. For standard user loads (i.e., excluding noise analysis with spectral index, automatic discontinuity search, and large wavelet analysis), up to 24 parallel users can be sustained, possibly a few more than that. However, it is not very clear how many simultaneous connections the Shinyapps server allows from the same inbound IP address; that limit may be set somewhere between 10 and 15. If using SARI in a class with many people and connections start being refused, I suggest changing the outbound IP address (for instance, connecting through a smartphone hotspot) or using SARI from a local server (RStudio or Docker).<br />
Contact the <a href="#author"><a href="#author" target="_self">author</a></a> for further information.</p>
<p>For the sake of simplicity of the model equation, SARI uses a common nonlinear LS function that most of the time converges in one iteration as expected. On very rare occasions, the fit does not converge, even with very simplistic models that usually include a sinusoid. A <em>“unable to fit the LS model. Change the model components”</em> message is shown on the screen. To avoid this problem, changing slightly the reference epoch of one of the model parameters should be enough to reach convergence.<br />
Contact the <a href="#author"><a href="#author" target="_self">author</a></a> if you encounter this problem.</p>
<p>The Kalman filter/smoother is significantly slower than the least squares fit, at least for typical GNSS position series I have tested and especially if the model has many parameters. Between EKF and UKF, UKF is theoretically more robust against nonlinearity, though this may not represent a big difference for typical GNSS series. Therefore, UKF is the preferred Kalman flavor by default, and it is the algorithm behind the measurement noise optimization as well (see the <a href="#iv.-fit-controls"><a href="#fit-controls" target="_self">Fit controls</a></a> block).<br />
However, I have noticed that, for some series and depending on the model being fitted, the UKF provides negative variances at some epochs for some of the estimated state parameters.<br />
In my tests, the state itself looks good, so at this point, I am not sure what is wrong with the variances, but it may be related to rounding errors or to the unscented transformation of the selected sigma points.<br />
The uncertainty of the estimated state parameters at the affected epochs will be set to <em>NA</em> in the downloaded file. If you encounter this problem, you can use the EKF implementation.<br />
Also, note that EKF and UKF are not necessarily providing the same fit to the series.</p>
<p>At this moment, I have not found a way to select the output directory on the client’s side, where the user downloads the processed series, from the online server’s side to avoid the repetitive, and sometimes annoying, download prompt. This is related to server/client standard secure browsing. At least, some web browsers provide extensions to automatically download to a specific directory given the file extension or to avoid the unnecessary <em>(1)</em>, <em>(2)</em>, … added to the file name if downloaded several times.<br />
If running SARI on a local server (RStudio or Docker), there is a sixth block at the bottom of the left panel, hidden for remote connections, that allows setting a directory on your machine and save the results there with just a button click (no download prompt).</p>
<hr />
<h1 id="acknowledgements">
</h1>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h1 id="acknowledgements">Acknowledgements</h1>
<p>I’m open to any constructive comment or suggestion that could improve this software, including bug repports or missing features.<br />
For any comment or question, please open a <a href="https://github.com/alvarosantamariagomez/sari">github issue</a>.</p>
<p>If you use SARI for your research, I would really appreciate it if you could include <a href="https://link.springer.com/article/10.1007/s10291-019-0846-y">this paper</a> in your references.</p>
<p>As for me, I am thankful to these people that directly or indirectly contributed to improve this software (some of them more than once):</p>
<p>Valérie Ballu, Sylvain Loyer, Paul Rebischung, Pascal Gegout, Giorgi Khazaradze, Alexandre Michel, Emilie Klein, Jean-Michel Lemoine, Guy Wöppelmann, Sara Padilla, Sorin Nistor, Massyl Ouaddour, Kevin Gobron, Juan J. Portela Fernández, Marianne Métois, Andrea Walpersdorf, Germinal Gabalda, Hanane Ait-Lakbir, Florent Feriol, Médéric Gravelle, David Rodríguez Collantes, Daniel Moreira Medeiros, Elena Gimenez de Ory, Audrey Hyeans, Julie Cheynel, Mikaël Guichard, Joëlle Nicolas, Laurent Soudarin, Guilhem Moreaux.</p>
<p>SARI is accessible to anyone at the Shinyapps server thanks to the financial support of the <a href="http://renag.resif.fr/en/">RENAG National Observing Service</a>.</p>
<hr />
<h1 id="references">
</h1>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h1 id="references">References</h1>
<p>Altamimi Z, Métivier L, Rebischung P, Collilieux X, Chanard K, Barnéoud J (2023) ITRF2020 plate motion model. Geophysical Research Letters, 50. doi: https://doi.org/10.1029/2023GL106373</p>
<p>Argus DF, Gordon RG, DeMets C (2011) Geologically current motion of 56 plates relative to the no-net-rotation reference frame. Geochemistry, Geophysics, Geosystems, 12, 11. doi: https://doi.org/10.1029/2011GC003751</p>
<p>Bird P (2003) An updated digital model of plate boundaries. Geochemistry, Geophysics, Geosystems, 4, 3. doi: https://doi.org/10.1029/2001GC000252</p>
<p>Blewitt G, Kreemer C, Hammond WC, Gazeaux J (2016) MIDAS robust trend estimator for accurate GPS station velocities without step detection. J Geophys Res Solid Earth 121(3):2054-2068. doi: https://doi.org/10.1002/2015JB012552</p>
<p>Brent RP (1971) An algorithm with guaranteed convergence for finding a zero of a function. Comput J 14(4):422-425. doi: https://doi.org/10.1093/comjnl/14.4.422</p>
<p>Caron L, Ivins ER (2019) A baseline Antarctic GIA correction for space gravimetry. Earth and Planetary Science Letters, 115957. doi: https://doi.org/10.1016/j.epsl.2019.115957</p>
<p>Eyer L, Bartholdi P (1999) Variable stars: Which Nyquist frequency? Astron Astrophys Suppl Ser 135, 1–3. doi: https://doi.org/10.1051/aas:1999102</p>
<p>Julier SJ, Uhlmann JK (2004) Unscented filtering and nonlinear estimation. Proc IEEE 92(3):401-422. doi: https://doi.org/10.1109/JPROC.2003.823141</p>
<p>Keitt TH (2008) Coherent ecological dynamics induced by large-scale disturbance. Nature 454:331-334. doi: https://doi.org/10.1038/nature06935</p>
<p>Kreemer C, Blewitt G, Klein EC (2014) A Geodetic Plate Motion and Global Strain Rate Model. Geochemistry, Geophysics, Geosystems, 15, 10. doi: https://doi.org/10.1002/2014GC005407</p>
<p>RESIF (2017) RESIF-RENAG French National Geodetic Network. RESIF - Réseau Sismologique et géodésique Français. doi: https://doi.org//10.15778/resif.rg</p>
<p>Peltier WR, Argus DF, Drummond R (2018) Comment on “An assessment of the ICE-6G_C (VM5a) glacial isostatic adjustment model” by Purcell et al. J Geophys Res Solid Earth, 123. doi:https://doi.org/10.1002/2016JB013844</p>
<p>Purcell A, Tregoning P, Dehecq A (2016) An assessment of the ICE6G_C(VM5a) glacial isostatic adjustment model. J. Geophys. Res. Solid Earth, 121. doi:https://doi.org/10.1002/2015JB012742</p>
<p>Saleh J, Bennett RA, Williams SDP (2024) Minimum-entropy velocity estimation from GPS position time series. J Geod 98:11. doi: https://doi.org/10.1007/s00190-023-01820-3</p>
<p>Särkkä S (2008) Unscented Rauch–Tung–Striebel Smoother. IEEE Transactions on Automatic Control, 53(3):845-849. doi: https://doi.org/10.1109/TAC.2008.919531</p>
<p>Schnabel RB, Koontz JE, Weiss BE (1985) A modular system of algorithms for unconstrained minimization. ACM Transactions on Mathematical Software, 11. https://doi.org/10.1145/6187.6192</p>
<p>Vondrák J (1977) Problem of Smoothing Observational Data II. Bull Astron Inst Czechoslov 28:84</p>
<p>Williams SDP (2003) The effect of coloured noise on the uncertainties of rates estimated from geodetic time series. J Geod 76(9-10):483-494. doi: https://doi.org/10.1007/s00190-002-0283-4</p>
<p>Zeileis A, Kleiber C, Krämer W, Hornik K (2003) Testing and Dating of Structural Changes in Practice, Computational Statistics and Data Analysis, 44, 109-123. doi: https://doi.org/10.1016/S0167-9473(03)00030-6</p>
<hr />
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h1 id="r-packages">R packages</h1>
<p>Attali D (2021) shinyjs: Easily Improve the User Experience of Your Shiny Apps in Seconds. R package version 2.1.0. https://CRAN.R-project.org/package=shinyjs</p>
<p>Azzalini A, Genz A (2022) The R package ‘mnormt’: The multivariate normal and ‘t’ distributions (version 2.1.1). http://azzalini.stat.unipd.it/SW/Pkg-mnormt/</p>
<p>Bailey E (2022) shinyBS: Twitter Bootstrap Components for Shiny. R package version 0.61.1. https://CRAN.R-project.org/package=shinyBS</p>
<p>Barrett T, Dowle M, Srinivasan A, Gorecki J, Chirico M, Hocking T (2024) data.table: Extension of data.frame. R package version 1.15.4. https://CRAN.R-project.org/package=data.table</p>
<p>Bates D, Eddelbuettel D (2013). Fast and Elegant Numerical Linear Algebra Using the RcppEigen Package. Journal of Statistical Software, 52(5), 1-24. doi: 10.18637/jss.v052.i05 (URL: https://doi.org/10.18637/jss.v052.i05).</p>
<p>Bengtsson H (2024) matrixStats: Functions that Apply to Rows and Columns of Matrices (and to Vectors). R package version 1.3.0. https://CRAN.R-project.org/package=matrixStats</p>
<p>Borchers HW (2023) pracma: Practical Numerical Math Functions. R package version 2.4.4. https://CRAN.R-project.org/package=pracma</p>
<p>Chamberlain S, Teucher A, Mahoney M (2023) geojsonio: Convert Data from and to ‘GeoJSON’ or ‘TopoJSON’. R package version 0.11.3. https://CRAN.R-project.org/package=geojsonio</p>
<p>Chang W (2021) shinythemes: Themes for Shiny. R package version 1.2.0. https://CRAN.R-project.org/package=shinythemes</p>
<p>Chang W, Cheng J, Allaire JJ, Sievert C, Schloerke B, Xie Y, Allen J, McPherson J, Dipert A, Borges B (2024) shiny: Web Application Framework for R. R package version 1.8.1.1. https://CRAN.R-project.org/package=shiny</p>
<p>Cheng J, Schloerke B, Karambelkar B, Xie Y (2024) leaflet: Create Interactive Web Maps with the JavaScript ‘Leaflet’ Library. R package version 2.2.2. https://CRAN.R-project.org/package=leaflet</p>
<p>Eddelbuettel D, Francois R, Allaire J, Ushey K, Kou Q, Russell N, Ucar I, Bates D, Chambers J (2023). Rcpp: Seamless R and C++ Integration. R package version 1.0.11, &lt;URL: https://CRAN.R-project.org/package=Rcpp&gt;.</p>
<p>Eddelbuettel D, Francois R, Bates D, Ni B, Sanderson C (2024). RcppArmadillo: ‘Rcpp’ Integration for the ‘Armadillo’ Templated Linear Algebra Library. R package version 14.0.0-1, &lt;URL: https://CRAN.R-project.org/package=RcppArmadillo&gt;.</p>
<p>Gilbert P, Varadhan R (2019) numDeriv: Accurate Numerical Derivatives. R package version 2016.8-1.1. https://CRAN.R-project.org/package=numDeriv</p>
<p>Grolemund G, Wickham H (2011) Dates and Times Made Easy with lubridate. Journal of Statistical Software, 40(3), 1-25. https://www.jstatsoft.org/v40/i03/</p>
<p>Keitt TH (2019) mvcwt: Wavelet Analysis of Multiple Time Series. R package version 1.3.1. https://CRAN.R-project.org/package=mvcwt</p>
<p>Milton Bache S, Wickham H (2022) magrittr: A Forward-Pipe Operator for R. R package version 2.0.3. https://CRAN.R-project.org/package=magrittr</p>
<p>Neuwirth E (2022) RColorBrewer: ColorBrewer Palettes. R package version 1.1-3. https://CRAN.R-project.org/package=RColorBrewer</p>
<p>Nychka D, Furrer R, Paige J, Sain S (2021) fields: Tools for spatial data. R package version 15.2. https://github.com/dnychka/fieldsRPackage</p>
<p>Ooms J (2014) The jsonlite Package: A Practical and Consistent Mapping Between JSON Data and R Objects. arXiv:1403.2805. https://arxiv.org/abs/1403.2805.</p>
<p>Petris G (2010) An R Package for Dynamic Linear Models. Journal of Statistical Software, 36(12), 1-16. https://www.jstatsoft.org/v36/i12/.</p>
<p>Petris, Petrone, and Campagnoli (2009) Dynamic Linear Models with R. Springer.</p>
<p>Revelle W (2024) psych: Procedures for Psychological, Psychometric, and Personality Research. Northwestern University, Evanston, Illinois. R package version 2.4.3. https://CRAN.R-project.org/package=psych.</p>
<p>Sali A, Attali D (2020) shinycssloaders: Add Loading Animations to a ‘shiny’ Output While It’s Recalculating. R package version 1.0.0. https://CRAN.R-project.org/package=shinycssloaders</p>
<p>Seilmayer M (2021) spectral: Common Methods of Spectral Data Analysis. R package version 2.0. https://CRAN.R-project.org/package=spectral</p>
<p>Temple Lang D (2023) RCurl: General Network (HTTP/FTP/…) Client Interface for R. R package version 1.98-1.12. https://CRAN.R-project.org/package=RCurl</p>
<p>Temple Lang D (2023) XML: Tools for Parsing and Generating XML Within R and S-Plus. R package version 3.99-0.14. https://CRAN.R-project.org/package=XML</p>
<p>Trapletti A, Hornik K (2024) tseries: Time Series Analysis and Computational Finance. R package version 0.10-56. https://CRAN.R-project.org/package=tseries</p>
<p>Xie Y, Allaire JJ, Horner J (2024) markdown: Render Markdown with ‘commonmark’. R package version 1.13. https://CRAN.R-project.org/package=markdown</p>
<p>Zeileis A, Leisch F, Hornik K, Kleiber C (2002) strucchange: An R Package for Testing for Structural Change in Linear Regression Models. Journal of Statistical Software, 7(2), 1-38. doi: 10.18637/jss.v007.i02. https://doi.org/10.18637/jss.v007.i02.</p>
<hr />
<h1 id="author">
</h1>
<h1 id="author">Author</h1>
<p>This software is developed and is maintained by</p>
<p><a href="https://www.get.omp.eu/author/ALVARO-SANTAMARIA/"><strong>Alvaro Santamaría</strong></a><br />
Centre National d’Etudes Spatiales<br />
Geosciences Environnement Toulouse<br />
Université de Toulouse, CNES, CNRS, IRD, UPS<br />
Observatoire Midi-Pyrénées<br />
Toulouse</p>
<p>For any comments, suggestions, questions, bugs, unexpected crashes or missing features, please open a github issue <a href="https://github.com/alvarosantamariagomez/sari">here</a>.</p>
<p> </p>
<p><a href="https://cnes.fr/en"><img src="cnes.png" alt="CNES" /></a>    <a href="https://www.get.omp.eu/en/geosciences-environnement-toulouse-en/"><img src="get.png" alt="GET" /></a>    <a href="https://www.omp.eu"><img src="omp.png" alt="OMP" /></a>   </p>
<p><a href="https://renag.resif.fr/en/"><img src="eposfr-renag.png" alt="RENAG" /></a></p>
<hr />
<h1 id="policy">
</h1>
<p><a href="#contents"><a href="#contents" target="_self">Go to top of document</a></a></p>
<h1 id="privacy-policy">Privacy policy</h1>
<ul>
<li><p>When using SARI via the online server at Shinyapps.io:<br />
The app uses essential first-party cookies to collect aggregated data on the amount of server resources (memory and duration) being used. These data are necessary for billing purposes of the online hosting service.<br />
The online server logs contain technical information on the users’ workflow, like the activation of some of the options and functions, which allows developping the app operation, for instance, in case of error. This information is not shared with third-parties and fully respects the anonymity of users and their own data.</p>
<p>SARI also uses the open-source <a href="https://en.wikipedia.org/wiki/Matomo_(software)">Matomo web analytics software</a> to collect information about the approximate geographic location (country and city), device type, operating system, browser, language and screen size. The IP, user ID and device ID are anonymized, which means that no personal information is collected from users.<br />
Both the Matomo software and its database are under full control on EU-based private servers and follow the guidelines set by the <a href="https://en.wikipedia.org/wiki/Commission_nationale_de_l%27informatique_et_des_libert%C3%A9s">National Commission on Informatics and Liberty</a> to comply with the current European <a href="https://en.wikipedia.org/wiki/General_Data_Protection_Regulation">General Data Protection Regulation</a>.<br />
Users can opt-out of the Matomo tracking by setting the “Do Not Track” (or Global Privacy Control) option in their web browser.</p>
<p>No third-party/non-essential cookies or cross-domain tracking are used by SARI. However, the app contains links to third-party websites. In order to access third-party content from SARI, the user may be asked to accept the terms and conditions, including cookie policies, from the external sites.</p></li>
<li><p>When using SARI from a local session (RStudio or Docker):<br />
No personal information is collected or tracked whatsoever. Only aggregated information on the number of GitHub/Docker downloads is obtained from these external sites.</p></li>
</ul>
<hr />
</div>
</body>
</html>
