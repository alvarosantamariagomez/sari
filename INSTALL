Instructions to run SARI locally using R/RStudio on Windows, Linux or MacOS
----------------------------------------------------------------------------

Note on the Windows Subsystem for Linux: if using scripts/sari.sh to launch SARI from a WSL terminal, R and all the package dependencies must be installed on WSL as well. The Windows install will only be accessible from Windows itself, for instance with RStudio. The windows install is not necessary if running SARI only from WSL.



1) Install R following the official R documentation here  
https://cran.r-project.org/

SARI has been tested on R version 4.2 (specifically patch 4.2.3). It is recommended to install this R release.



2) It is recommended to install RStudio (free desktop version), especially if using Windows, though this is not mandatory to run SARI  
https://www.rstudio.com/products/rstudio/download/



3) With R (and RStudio) installed, some extras may be needed before installing the SARI dependencies


3.1) If using Windows: install Rtools following these instructions  
https://cran.r-project.org/bin/windows/Rtools/

Once Rtools is installed, in order to use it, you need first to install and load the package devtools.  
On the R/RStudio console type:    
`
install.packages("devtools")  
library(devtools)
`

3.2) If using macOS: install Xcode and a GNU Fortran compiler (not fully tested, feedback is welcome) following:  
https://mac.r-project.org/tools/

3.3) If using Linux/WSL: install the following packages on your system (it may vary depending on the distro):  
`
sudo apt-get install -y make zlib1g-dev libcurl4-openssl-dev libssl-dev libfontconfig1-dev libfreetype6-dev libfribidi-dev libharfbuzz-dev libjpeg-dev libpng-dev libtiff-dev pandoc libicu-dev libxml2-dev git libgit2-dev
`


4) Install all the R packages indicated below and their dependencies from CRAN. There are several ways of installing the required packages:  

4.1) On Rstudio, go to Tools -> Install Packages  
Then copy&paste the following list of packages separated by spaces or commas:

data.table, devtools, dlm, fields, lubridate, magrittr, markdown, matrixStats, numDeriv, pracma, psych, RColorBrewer, RCurl, XML, jsonlite, shinyBS, shinycssloaders, shinyjs, shinythemes, shiny, spectral, strucchange, tseries, foreach

4.2) On the R/RStudio console, the following command will install all the packages:  
`
install.packages(c("data.table", "devtools", "dlm", "fields", "lubridate", "magrittr", "markdown", "matrixStats", "numDeriv", "pracma", "psych", "RColorBrewer", "RCurl", "XML", "jsonlite", "shinyBS", "shinycssloaders", "shinyjs", "shinythemes", "shiny", "spectral", "strucchange", "tseries", "foreach", "mnormt"))
`

4.3) The above two methods will either install package binaries on Windows (probably on macOS as well) or compile packages from source on Linux, which may take a long time. A third method would consist on installing the Linux binaries, if a repo is available on CRAN. This method depends on each Linux distro and will not be described here.



5) In addition, the package "mvcwt" can be installed as an option. If installed, this package allows computing wavelet transforms. This package can be downloaded from here:  
https://cran.r-project.org/src/contrib/Archive/mvcwt/

To install this package there are two options:

5.1) On Rstudio, go to Tools -> Install Packages and select the downloaded mvcwt tar.gz file from your machine.

5.2) On the R/Rstudio console type:  
`
install.packages("/path/to/the/mvcwt/tar.gz/file")
`


6) The package "leaflet" is also optional. If installed, this package allows adding an interactive location map when the GNSS station coordinates are known. This package can be installed like the others, but it requires installing the GDAL library first, at least in order to compile the package on a Linux system. For Windows, this can be avoided if installing the package binary file.  
More information on the GDAL library here:  
https://gdal.org/download.html



The list below shows the package versions used when accessing SARI from Docker or the Shinyapps server. Installing the required packages with a different version may produce different results. 

Package         Version
leaflet         v2.1.2
tseries         v0.10-49
strucchange     v1.5-2
sandwich        v3.0-1
zoo             v1.8-9
spectral        v2.0
pbapply         v1.5-0
RhpcBLASctl     v0.21-247.1
lattice         v0.20-45
rasterImage     v0.4.0
plotrix         v3.8-2
shinythemes     v1.2.0
shinyjs         v2.0.0
shinycssloaders v1.0.0.9000
shinyBS         v0.61
jsonlite        v1.8.0
XML             v3.99-0.14
RCurl           v1.98-1.12
RColorBrewer    v1.1-2
psych           v2.1.9
pracma          v2.3.8
numDeriv        v2016.8-1.1
mvcwt           v1.3.1
mnormt          v2.0.2
matrixStats     v0.61.0
markdown        v1.1
magrittr        v2.0.3
lubridate       v1.8.0
fields          v13.3
viridis         v0.6.2
viridisLite     v0.4.0
spam            v2.7-0
dotCall64       v1.0-1
dlm             v1.1-5
data.table      v1.14.2
shiny           v1.7.3

If the installed shinycssloaders package is not exactly version 1.0.0.9 or later, you need to install this version from its github repo using:  
`
devtools::install_github("daattali/shinycssloaders")
`



7) Once all the packages are installed, there are three ways to run SARI:

7.1) On RStudio: clone/download the SARI repo, open the app.R script and use one of these:

click on RunApp (run external)

or

go to Code -> Source

or

Ctrl + Shift + S

7.2) On the R/RStudio console type one of these:

To run SARI without cloning the repo:  
`
library(shiny)  
runGitHub("sari", "alvarosantamariagomez", launch.browser=T)
`

or

After cloning/downloading the SARI repo:  
`
runApp("/path/to/the/downloaded/SARI/app.R/file")
`

7.3) On a Unix-like terminal using the sari.sh shell script located in the /scripts folder of the SARI repo.  
This shell script can also be used to launch a local SARI session with Docker or a remote SARI session on Shinyapps.io without installing SARI.



For any comment or question, open a GitHub issue at
https://github.com/alvarosantamariagomez/sari



Alvaro Santamaria
alvaro.santamaria at get.omp.eu
